# OmniAgent å†—ä½™å¤‡ä»½æ–¹æ¡ˆå®Œæ•´æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [æ–¹æ¡ˆæ¦‚è¿°](#æ–¹æ¡ˆæ¦‚è¿°)
2. [å†—ä½™ç­–ç•¥](#å†—ä½™ç­–ç•¥)
3. [å¿«é€Ÿå¯åŠ¨](#å¿«é€Ÿå¯åŠ¨)
4. [é…ç½®è¯¦è§£](#é…ç½®è¯¦è§£)
5. [ç›‘æ§å’Œç®¡ç†](#ç›‘æ§å’Œç®¡ç†)
6. [APIæ¥å£](#apiæ¥å£)
7. [æ•…éšœæ¢å¤](#æ•…éšœæ¢å¤)
8. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## æ–¹æ¡ˆæ¦‚è¿°

### ğŸ¯ è®¾è®¡ç›®æ ‡

- âœ… **æ•°æ®å®‰å…¨**ï¼šå¤šé‡å¤‡ä»½ç¡®ä¿æ•°æ®ä¸ä¸¢å¤±
- âœ… **é«˜å¯ç”¨æ€§**ï¼šä¸»å¤‡è‡ªåŠ¨åˆ‡æ¢ï¼ŒæœåŠ¡ä¸ä¸­æ–­
- âœ… **å¼‚æ„å†—ä½™**ï¼šä¸åŒæŠ€æœ¯æ ˆé¿å…å•ç‚¹æ•…éšœ
- âœ… **è‡ªåŠ¨ç›‘æ§**ï¼šå®æ—¶å¥åº·æ£€æŸ¥å’Œæ•…éšœæ¢å¤
- âœ… **æ•°æ®ä¸€è‡´æ€§**ï¼šå®šæœŸæ ¡éªŒå’Œè‡ªåŠ¨ä¿®å¤

### ğŸ—ï¸ æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åº”ç”¨å±‚ (Application)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               å†—ä½™å¤‡ä»½ç›‘æ§æœåŠ¡ (Monitoring)                â”‚
â”‚  â€¢ å¥åº·æ£€æŸ¥  â€¢ ä¸€è‡´æ€§éªŒè¯  â€¢ è‡ªåŠ¨æ¢å¤  â€¢ çŠ¶æ€æŠ¥å‘Š         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æŒä¹…åŒ–å±‚ (Persistence)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸»å­˜å‚¨ (Primary)                                         â”‚
â”‚  â””â”€ SQLite (è½»é‡çº§ã€é«˜æ€§èƒ½)                               â”‚
â”‚                                                           â”‚
â”‚  å¤‡ä»½å­˜å‚¨ (Secondary) - å¼‚æ„å†—ä½™                          â”‚
â”‚  â”œâ”€ File   (æ–‡ä»¶ç³»ç»Ÿã€äººå·¥å¯è¯»)                           â”‚
â”‚  â””â”€ H2     (åµŒå…¥å¼æ•°æ®åº“ã€å…¼å®¹æ€§å¥½)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                æ–‡æ¡£å­˜å‚¨å±‚ (Document Storage)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸»å­˜å‚¨ (Primary)                                         â”‚
â”‚  â””â”€ File System (./data/primary/documents/)              â”‚
â”‚                                                           â”‚
â”‚  å¤‡ä»½å­˜å‚¨ (Backup) - åŒç§å†—ä½™                             â”‚
â”‚  â”œâ”€ Backup1 (./data/backup/documents/backup1/)          â”‚
â”‚  â”œâ”€ Backup2 (./data/backup/documents/backup2/)          â”‚
â”‚  â””â”€ Backup3 (./data/backup/documents/backup3/)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RAGæ£€ç´¢å±‚ (RAG)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸»æ£€ç´¢ (Primary)                                         â”‚
â”‚  â””â”€ Lucene (é«˜æ€§èƒ½å…¨æ–‡æ£€ç´¢)                               â”‚
â”‚                                                           â”‚
â”‚  å¤‡ä»½æ£€ç´¢ (Backup) - å¼‚æ„å†—ä½™                             â”‚
â”‚  â””â”€ SQLite FTS5 (å¤‡ç”¨å…¨æ–‡æ£€ç´¢)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AIæœåŠ¡å±‚ (AI)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸»æœåŠ¡ (Primary)                                         â”‚
â”‚  â””â”€ Online API (åƒé—®/OpenAI/Claude)                      â”‚
â”‚                                                           â”‚
â”‚  æ•…éšœè½¬ç§» (Failover)                                      â”‚
â”‚  â””â”€ Local Ollama (æœ¬åœ°éƒ¨ç½²)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å†—ä½™ç­–ç•¥

### 1ï¸âƒ£ æŒä¹…åŒ–å±‚ - å¼‚æ„å†—ä½™

| å­˜å‚¨ç±»å‹ | è§’è‰² | ä¼˜åŠ¿ | ç”¨é€” |
|---------|------|------|------|
| **SQLite** | ä¸»å­˜å‚¨ | è½»é‡ã€é«˜æ€§èƒ½ã€é›¶é…ç½® | ä¸»è¦è¯»å†™æ“ä½œ |
| **File** | å¤‡ä»½1 | äººå·¥å¯è¯»ã€æ˜“äºæ£€æŸ¥ | æ•…éšœæ’æŸ¥ã€äººå·¥æ¢å¤ |
| **H2** | å¤‡ä»½2 | å…¼å®¹æ€§å¥½ã€æ ‡å‡†SQL | å¼‚æ„å¤‡ä»½ã€è¿ç§»å‹å¥½ |

**å†™å…¥ç­–ç•¥**ï¼š
- ä¸»å­˜å‚¨ï¼šåŒæ­¥å†™å…¥ï¼ˆä¿è¯ä¸€è‡´æ€§ï¼‰
- å¤‡ä»½å­˜å‚¨ï¼šå¼‚æ­¥å†™å…¥ï¼ˆæé«˜æ€§èƒ½ï¼‰

### 2ï¸âƒ£ æ–‡æ¡£å­˜å‚¨å±‚ - åŒç§å†—ä½™

| è·¯å¾„ | è§’è‰² | åŒæ­¥ç­–ç•¥ |
|------|------|---------|
| `./data/primary/documents/` | ä¸»å­˜å‚¨ | å®æ—¶å†™å…¥ |
| `./data/backup/documents/backup1/` | å¤‡ä»½1 | 5åˆ†é’ŸåŒæ­¥ |
| `./data/backup/documents/backup2/` | å¤‡ä»½2 | 5åˆ†é’ŸåŒæ­¥ |
| `./data/backup/documents/backup3/` | å¤‡ä»½3 | 5åˆ†é’ŸåŒæ­¥ |

**ç‰¹ç‚¹**ï¼š
- å¤šè·¯å¾„ç‰©ç†éš”ç¦»
- å®šæ—¶è‡ªåŠ¨åŒæ­¥
- å¯é…ç½®åˆ°ä¸åŒç£ç›˜/æŒ‚è½½ç‚¹

### 3ï¸âƒ£ RAGæ£€ç´¢å±‚ - å¼‚æ„å†—ä½™

| å¼•æ“ | è§’è‰² | ç‰¹ç‚¹ |
|------|------|------|
| **Lucene** | ä¸»æ£€ç´¢ | é«˜æ€§èƒ½ã€ä¸°å¯ŒåŠŸèƒ½ |
| **SQLite FTS5** | å¤‡ä»½æ£€ç´¢ | è½»é‡ã€æ˜“ç»´æŠ¤ |

**è‡ªåŠ¨åŒæ­¥**ï¼š
- ä¸»ç´¢å¼•æ›´æ–°æ—¶è‡ªåŠ¨åŒæ­¥åˆ°å¤‡ä»½
- å¤‡ä»½ç´¢å¼•ç‹¬ç«‹å­˜å‚¨

### 4ï¸âƒ£ AIæœåŠ¡å±‚ - æ•…éšœè½¬ç§»

| æä¾›å•† | è§’è‰² | ä¼˜å…ˆçº§ |
|--------|------|--------|
| **Online API** | ä¸»æœåŠ¡ | P0 |
| **Local Ollama** | å¤‡ç”¨æœåŠ¡ | P1 |

**æ•…éšœè½¬ç§»ç­–ç•¥**ï¼š
- åœ¨çº¿APIå¤±è´¥ â†’ è‡ªåŠ¨åˆ‡æ¢åˆ°æœ¬åœ°Ollama
- æ”¯æŒæ‰‹åŠ¨æŒ‡å®šä¼˜å…ˆçº§

---

## å¿«é€Ÿå¯åŠ¨

### æ­¥éª¤1ï¼šç¼–è¯‘é¡¹ç›®

```bash
cd D:\Jetbrains\omni-agent
mvn clean install -DskipTests
```

### æ­¥éª¤2ï¼šå¯åŠ¨åº”ç”¨ï¼ˆä½¿ç”¨å†—ä½™é…ç½®ï¼‰

```bash
cd omni-agent-p2p-basic
mvn spring-boot:run -Dspring-boot.run.profiles=redundant
```

æˆ–è€…ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼š

```bash
export SPRING_PROFILES_ACTIVE=redundant
mvn spring-boot:run
```

### æ­¥éª¤3ï¼šéªŒè¯å¯åŠ¨

è®¿é—®å¥åº·æ£€æŸ¥æ¥å£ï¼š

```bash
curl http://localhost:8080/api/backup/health
```

é¢„æœŸå“åº”ï¼š

```json
{
  "success": true,
  "healthy": true,
  "totalBackends": 3,
  "healthyBackends": 3,
  "message": "All backup backends are healthy"
}
```

---

## é…ç½®è¯¦è§£

### æ ¸å¿ƒé…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶ä½ç½®ï¼š`src/main/resources/application-redundant.yml`

### 1. æŒä¹…åŒ–é…ç½®

```yaml
omni-agent:
  persistence:
    strategy: composite          # å¯ç”¨ç»„åˆç­–ç•¥
    primary-type: sqlite         # ä¸»å­˜å‚¨ç±»å‹
    secondary-types:             # å¤‡ä»½å­˜å‚¨
      - file
      - h2
    
    sqlite:
      db-path: ./data/primary/sqlite/omni-agent.db
      auto-create-tables: true
    
    file:
      base-path: ./data/backup/persistence/file
      auto-backup: true
    
    h2:
      jdbc-url: jdbc:h2:file:./data/backup/persistence/h2/omni-agent
```

### 2. æ–‡æ¡£å­˜å‚¨é…ç½®

```yaml
omni-agent:
  document-storage:
    type: file
    file:
      base-path: ./data/primary/documents
      backup-paths:                    # å¤šè·¯å¾„å¤‡ä»½
        - ./data/backup/documents/backup1
        - ./data/backup/documents/backup2
        - ./data/backup/documents/backup3
      auto-sync-backup: true           # è‡ªåŠ¨åŒæ­¥
      sync-interval: 300000            # 5åˆ†é’Ÿ
```

### 3. ç›‘æ§é…ç½®

```yaml
omni-agent:
  backup:
    monitoring:
      enabled: true
      check-interval: 60000          # 1åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
    
    health-check:
      enabled: true
      alert-on-failure: true
    
    auto-recovery:
      enabled: true
      max-retry: 3
      retry-interval: 5000           # 5ç§’
    
    consistency-check:
      enabled: true
      check-interval: 3600000        # 1å°æ—¶
      auto-repair: true
```

---

## ç›‘æ§å’Œç®¡ç†

### å¯åŠ¨æ—¥å¿—

æˆåŠŸå¯åŠ¨æ—¶ä¼šçœ‹åˆ°ï¼š

```log
2025-12-16 20:40:00 [main] INFO  t.y.a.o.e.b.backup.BackupMonitoringService
  - ğŸ” BackupMonitoringService initialized
  - Monitoring enabled: true
  - Health check enabled: true
  - Auto recovery enabled: true

2025-12-16 20:40:00 [main] INFO  t.y.a.o.e.b.backup.BackupMonitoringService
  - âœ… Registered backup backend: primary
  - âœ… Registered backup backend: secondary-file
  - âœ… Registered backup backend: secondary-h2
```

### å®šæ—¶ä»»åŠ¡

ç³»ç»Ÿä¼šè‡ªåŠ¨æ‰§è¡Œï¼š

1. **å¥åº·æ£€æŸ¥**ï¼šæ¯1åˆ†é’Ÿ
2. **ä¸€è‡´æ€§æ£€æŸ¥**ï¼šæ¯1å°æ—¶
3. **æ•…éšœæ¢å¤**ï¼šæ£€æµ‹åˆ°æ•…éšœæ—¶è‡ªåŠ¨è§¦å‘

---

## APIæ¥å£

### 1. è·å–å¤‡ä»½çŠ¶æ€

**è¯·æ±‚**ï¼š

```bash
GET http://localhost:8080/api/backup/status
```

**å“åº”**ï¼š

```json
{
  "success": true,
  "timestamp": "2025-12-16T20:40:00",
  "totalBackends": 3,
  "healthyBackends": 3,
  "unhealthyBackends": 0,
  "statistics": {
    "healthyChecks": 120,
    "unhealthyChecks": 0,
    "failedChecks": 0,
    "recoverySuccess": 0,
    "recoveryFailures": 0,
    "consistencyChecks": 2,
    "inconsistencyDetected": 0,
    "repairSuccess": 0,
    "repairFailures": 0
  }
}
```

### 2. å¥åº·æ£€æŸ¥æ‘˜è¦

**è¯·æ±‚**ï¼š

```bash
GET http://localhost:8080/api/backup/health
```

**å“åº”**ï¼š

```json
{
  "success": true,
  "healthy": true,
  "totalBackends": 3,
  "healthyBackends": 3,
  "message": "All backup backends are healthy"
}
```

### 3. æ‰‹åŠ¨è§¦å‘å¥åº·æ£€æŸ¥

**è¯·æ±‚**ï¼š

```bash
POST http://localhost:8080/api/backup/check
```

**å“åº”**ï¼š

```json
{
  "success": true,
  "message": "Health check completed successfully"
}
```

### 4. æ‰‹åŠ¨è§¦å‘ä¸€è‡´æ€§æ£€æŸ¥

**è¯·æ±‚**ï¼š

```bash
POST http://localhost:8080/api/backup/consistency-check
```

**å“åº”**ï¼š

```json
{
  "success": true,
  "message": "Consistency check completed successfully"
}
```

### 5. è·å–ç»Ÿè®¡ä¿¡æ¯

**è¯·æ±‚**ï¼š

```bash
GET http://localhost:8080/api/backup/statistics
```

**å“åº”**ï¼š

```json
{
  "success": true,
  "healthyChecks": 120,
  "unhealthyChecks": 0,
  "failedChecks": 0,
  "recoverySuccess": 0,
  "recoveryFailures": 0,
  "consistencyChecks": 2,
  "inconsistencyDetected": 0,
  "repairSuccess": 0,
  "repairFailures": 0,
  "healthRate": "100.00%",
  "recoveryRate": "100.00%"
}
```

---

## æ•…éšœæ¢å¤

### è‡ªåŠ¨æ•…éšœæ¢å¤æµç¨‹

```
æ£€æµ‹åˆ°æ•…éšœ â†’ è®°å½•æ—¥å¿— â†’ è§¦å‘æ¢å¤ â†’ é‡è¯•3æ¬¡ â†’ æˆåŠŸ/å¤±è´¥
                â†“
            æ¯æ¬¡é—´éš”5ç§’
```

### æ•…éšœæ¢å¤æ—¥å¿—ç¤ºä¾‹

```log
2025-12-16 20:45:00 [scheduler] WARN  t.y.a.o.e.b.backup.BackupMonitoringService
  - âš ï¸  Backend secondary-file is unhealthy

2025-12-16 20:45:00 [scheduler] INFO  t.y.a.o.e.b.backup.BackupMonitoringService
  - ğŸ”§ Attempting to recover backend: secondary-file

2025-12-16 20:45:05 [scheduler] INFO  t.y.a.o.e.b.backup.BackupMonitoringService
  - âœ… Backend secondary-file recovered successfully
```

### ä¸€è‡´æ€§ä¿®å¤æ—¥å¿—ç¤ºä¾‹

```log
2025-12-16 21:00:00 [scheduler] WARN  t.y.a.o.e.b.backup.BackupMonitoringService
  - âš ï¸  Data inconsistency detected in backend: secondary-file

2025-12-16 21:00:00 [scheduler] INFO  t.y.a.o.e.b.backup.BackupMonitoringService
  - ğŸ”§ Repairing data inconsistency in backend: secondary-file

2025-12-16 21:00:01 [scheduler] INFO  t.y.a.o.e.b.backup.BackupMonitoringService
  - âœ… Data repaired successfully in backend: secondary-file
```

---

## æœ€ä½³å®è·µ

### 1. å­˜å‚¨è·¯å¾„è§„åˆ’

æ¨èå°†ä¸åŒå¤‡ä»½å­˜å‚¨åˆ°ä¸åŒç‰©ç†ç£ç›˜ï¼š

```yaml
document-storage:
  file:
    base-path: /disk1/data/primary/documents     # ä¸»ç£ç›˜
    backup-paths:
      - /disk2/backup/documents/backup1          # å¤‡ä»½ç£ç›˜2
      - /disk3/backup/documents/backup2          # å¤‡ä»½ç£ç›˜3
      - /nas/backup/documents/backup3            # NASç½‘ç»œå­˜å‚¨
```

### 2. ç›‘æ§å‘Šè­¦é›†æˆ

å»ºè®®é›†æˆåˆ°ç›‘æ§ç³»ç»Ÿï¼š

```java
@Component
public class BackupAlertService {
    
    @EventListener
    public void onBackupFailure(BackupFailureEvent event) {
        // å‘é€åˆ°ä¼ä¸šå¾®ä¿¡/é’‰é’‰/é‚®ä»¶
        alertManager.send(event);
    }
}
```

### 3. å®šæœŸå¤‡ä»½éªŒè¯

å»ºè®®æ¯å¤©éªŒè¯ä¸€æ¬¡å¤‡ä»½å®Œæ•´æ€§ï¼š

```bash
# æ·»åŠ åˆ° cron
0 2 * * * curl -X POST http://localhost:8080/api/backup/consistency-check
```

### 4. å¤‡ä»½æ•°æ®å¯¼å‡º

å®šæœŸå¯¼å‡ºå¤‡ä»½æ•°æ®åˆ°å¤–éƒ¨å­˜å‚¨ï¼š

```bash
# å‹ç¼©å¤‡ä»½
tar -czf backup-$(date +%Y%m%d).tar.gz ./data/backup/

# ä¸Šä¼ åˆ°äº‘å­˜å‚¨
aws s3 cp backup-$(date +%Y%m%d).tar.gz s3://my-bucket/
```

### 5. å®¹ç¾æ¼”ç»ƒ

å®šæœŸè¿›è¡Œæ•…éšœæ¼”ç»ƒï¼š

1. åœæ­¢ä¸»å­˜å‚¨
2. éªŒè¯ç³»ç»Ÿåˆ‡æ¢åˆ°å¤‡ä»½
3. æ¢å¤ä¸»å­˜å‚¨
4. éªŒè¯æ•°æ®åŒæ­¥

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•åˆ‡æ¢ä¸åŒçš„å†—ä½™æ–¹æ¡ˆï¼Ÿ

**A**: ä¿®æ”¹ `application-redundant.yml`ï¼Œè°ƒæ•´ `primary-type` å’Œ `secondary-types`

### Q2: å¤‡ä»½æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ

**A**: ä¸»å­˜å‚¨åŒæ­¥å†™å…¥ï¼Œå¤‡ä»½å­˜å‚¨å¼‚æ­¥å†™å…¥ï¼ˆæé«˜æ€§èƒ½ï¼‰

### Q3: å¦‚ä½•ç›‘æ§å¤‡ä»½çŠ¶æ€ï¼Ÿ

**A**: è®¿é—® `/api/backup/status` æŸ¥çœ‹å®æ—¶çŠ¶æ€

### Q4: æ•…éšœæ¢å¤éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ

**A**: é»˜è®¤é‡è¯•3æ¬¡ï¼Œæ¯æ¬¡é—´éš”5ç§’ï¼Œæœ€é•¿15ç§’

### Q5: èƒ½å¦åŠ¨æ€æ·»åŠ å¤‡ä»½ï¼Ÿ

**A**: å¯ä»¥ï¼Œä¿®æ”¹é…ç½®åé‡å¯åº”ç”¨å³å¯

---

## æ€»ç»“

âœ… **æ•°æ®å®‰å…¨**ï¼š3é‡å¼‚æ„å¤‡ä»½
âœ… **é«˜å¯ç”¨**ï¼šè‡ªåŠ¨æ•…éšœåˆ‡æ¢
âœ… **è‡ªåŠ¨åŒ–**ï¼šå®šæ—¶ç›‘æ§å’Œä¿®å¤
âœ… **å¯è§‚æµ‹**ï¼šå®Œæ•´çš„APIå’Œæ—¥å¿—
âœ… **çµæ´»æ€§**ï¼šå¯é…ç½®çš„å†—ä½™ç­–ç•¥

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸš€

