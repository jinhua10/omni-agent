# æ–‡æ¡£æµè§ˆå™¨ - æŸ¥çœ‹è¯¦æƒ…åŠŸèƒ½å¢å¼ºæŠ¥å‘Š

## âœ… åŠŸèƒ½å®ç°

åœ¨æ–‡æ¡£æµè§ˆå™¨çš„æ–‡ä»¶åˆ—è¡¨ä¸­ï¼Œç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"æŒ‰é’®æ—¶ï¼Œç°åœ¨å¯ä»¥æŸ¥çœ‹æ–‡æ¡£çš„æå–æ–‡æœ¬å†…å®¹ï¼Œå¹¶ä½¿ç”¨å·²å°è£…å¥½çš„ MarkdownRenderer ç»„ä»¶è¿›è¡Œæ¸²æŸ“å±•ç¤ºã€‚

## ğŸ”§ ä¿®æ”¹çš„æ–‡ä»¶

### 1. DocumentDetail.jsx (UI ç»„ä»¶)

**è·¯å¾„**: `UI/src/components/document/DocumentDetail.jsx`

#### ä¸»è¦æ”¹è¿›

1. **æ·»åŠ çŠ¶æ€ç®¡ç†**
   ```javascript
   const [extractedText, setExtractedText] = useState(null)
   const [loading, setLoading] = useState(false)
   const [error, setError] = useState(null)
   ```

2. **è‡ªåŠ¨è·å–æå–æ–‡æœ¬**
   ```javascript
   useEffect(() => {
     if (visible && document && document.fileName) {
       fetchExtractedText()
     }
   }, [visible, document])
   ```

3. **è°ƒç”¨åç«¯ API**
   ```javascript
   const fetchExtractedText = async () => {
     const encodedDocId = encodeURIComponent(document.fileName)
     const response = await fetch(`/api/documents/processing/${encodedDocId}/extraction-status`)
     const result = await response.json()
     
     if (result.success && result.data.extracted) {
       setExtractedText(result.data.content)
     }
   }
   ```

4. **ä½¿ç”¨ Tabs ç»„ç»‡å†…å®¹**
   - **åŸºæœ¬ä¿¡æ¯** Tab: æ˜¾ç¤ºæ–‡æ¡£çš„å…ƒæ•°æ®ï¼ˆåç§°ã€å¤§å°ã€ä¸Šä¼ æ—¶é—´ç­‰ï¼‰
   - **æå–æ–‡æœ¬** Tab: æ˜¾ç¤ºä½¿ç”¨ MarkdownRenderer æ¸²æŸ“çš„æå–æ–‡æœ¬

5. **ä½¿ç”¨ MarkdownRenderer æ¸²æŸ“**
   ```javascript
   <MarkdownRenderer content={extractedText} />
   ```

6. **å®Œå–„çš„çŠ¶æ€å±•ç¤º**
   - **åŠ è½½ä¸­**: æ˜¾ç¤º Spin ç»„ä»¶
   - **åŠ è½½å¤±è´¥**: æ˜¾ç¤º Alert é”™è¯¯æç¤º
   - **æœªæå–**: æ˜¾ç¤º Empty æç¤º
   - **å·²æå–**: ä½¿ç”¨ MarkdownRenderer æ¸²æŸ“å†…å®¹

### 2. zh.js (ä¸­æ–‡å›½é™…åŒ–)

**è·¯å¾„**: `UI/src/lang/zh.js`

**æ–°å¢æ–‡æœ¬**:
```javascript
basicInfo: 'åŸºæœ¬ä¿¡æ¯',
extractedText: 'æå–æ–‡æœ¬',
loadingExtractedText: 'æ­£åœ¨åŠ è½½æå–æ–‡æœ¬...',
loadError: 'åŠ è½½å¤±è´¥',
noExtractedText: 'è¯¥æ–‡æ¡£å°šæœªæå–æ–‡æœ¬å†…å®¹',
```

### 3. en.js (è‹±æ–‡å›½é™…åŒ–)

**è·¯å¾„**: `UI/src/lang/en.js`

**æ–°å¢æ–‡æœ¬**:
```javascript
basicInfo: 'Basic Info',
extractedText: 'Extracted Text',
loadingExtractedText: 'Loading extracted text...',
loadError: 'Load Error',
noExtractedText: 'This document has not been text extracted yet',
```

## ğŸ“Š UI å±•ç¤º

### è¯¦æƒ…å¯¹è¯æ¡†ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–‡æ¡£è¯¦æƒ…                              [Ã—]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [åŸºæœ¬ä¿¡æ¯]  [æå–æ–‡æœ¬]                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ã€åŸºæœ¬ä¿¡æ¯ Tabã€‘                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ–‡æ¡£åç§° â”‚ ç»¿è‰²ç¯ä¿èƒ½æºç¯æ³¡â€”â€”.ppt    â”‚ â”‚
â”‚  â”‚ å¤§å°     â”‚ 1.05 MB                   â”‚ â”‚
â”‚  â”‚ ä¸Šä¼ æ—¶é—´ â”‚ 2025-12-25 20:14:39       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  ã€æå–æ–‡æœ¬ Tabã€‘                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [Markdown æ¸²æŸ“çš„æå–å†…å®¹]            â”‚ â”‚
â”‚  â”‚                                       â”‚ â”‚
â”‚  â”‚ # æ ‡é¢˜                                â”‚ â”‚
â”‚  â”‚ å†…å®¹...                               â”‚ â”‚
â”‚  â”‚                                       â”‚ â”‚
â”‚  â”‚ [å¯æ»šåŠ¨æ˜¾ç¤ºå®Œæ•´å†…å®¹]                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### 1. æ™ºèƒ½åŠ è½½
- âœ… å¯¹è¯æ¡†æ‰“å¼€æ—¶è‡ªåŠ¨è·å–æå–æ–‡æœ¬
- âœ… å¯¹è¯æ¡†å…³é—­æ—¶æ¸…ç©ºæ•°æ®
- âœ… é¿å…é‡å¤è¯·æ±‚

### 2. çŠ¶æ€ç®¡ç†
- âœ… **åŠ è½½çŠ¶æ€**: æ˜¾ç¤º Spin åŠ è½½åŠ¨ç”»
- âœ… **é”™è¯¯çŠ¶æ€**: æ˜¾ç¤º Alert é”™è¯¯æç¤º
- âœ… **ç©ºçŠ¶æ€**: æ˜¾ç¤º Empty æç¤º"å°šæœªæå–"
- âœ… **æˆåŠŸçŠ¶æ€**: ä½¿ç”¨ MarkdownRenderer æ¸²æŸ“

### 3. ç”¨æˆ·ä½“éªŒ
- âœ… ä½¿ç”¨ Tabs åˆ†ç¦»åŸºæœ¬ä¿¡æ¯å’Œæå–æ–‡æœ¬
- âœ… æå–æ–‡æœ¬åŒºåŸŸå¯æ»šåŠ¨ï¼ˆæœ€å¤§é«˜åº¦ 60vhï¼‰
- âœ… æµ…ç°è‰²èƒŒæ™¯ï¼Œæ›´å¥½çš„é˜…è¯»ä½“éªŒ
- âœ… å›½é™…åŒ–æ”¯æŒï¼ˆä¸­è‹±æ–‡ï¼‰

### 4. Markdown æ¸²æŸ“
- âœ… ä½¿ç”¨å·²å°è£…çš„ MarkdownRenderer ç»„ä»¶
- âœ… æ”¯æŒå®Œæ•´çš„ Markdown è¯­æ³•
- âœ… ä»£ç é«˜äº®
- âœ… è¡¨æ ¼ã€åˆ—è¡¨ç­‰å¤æ‚æ ¼å¼

## ğŸ”„ å·¥ä½œæµç¨‹

```
ç”¨æˆ·ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"
    â†“
æ‰“å¼€ DocumentDetail å¯¹è¯æ¡†
    â†“
è§¦å‘ useEffect
    â†“
è°ƒç”¨ fetchExtractedText()
    â†“
GET /api/documents/processing/{documentId}/extraction-status
    â†“
DocumentProcessingController.getExtractionStatus()
    â†“
DocumentExtractionResultService.findByDocumentId()
    â†“
ä» data/storage/extracted/ è¯»å– JSON
    â†“
è¿”å›æå–ç»“æœ
    â†“
å‰ç«¯æ¥æ”¶æ•°æ®
    â†“
MarkdownRenderer æ¸²æŸ“å±•ç¤º
    â†“
ç”¨æˆ·æŸ¥çœ‹ Markdown æ ¼å¼çš„æ–‡æœ¬å†…å®¹
```

## ğŸ“ API æ¥å£

### è·å–æå–çŠ¶æ€
```
GET /api/documents/processing/{documentId}/extraction-status
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "extracted": true,
    "content": "# æ ‡é¢˜\n\nå†…å®¹...",
    "model": "vision-llm",
    "extractedAt": 1703472000000,
    "textLength": 5000,
    "pageCount": 12
  }
}
```

## ğŸ¨ æ ·å¼è°ƒæ•´

### Modal å®½åº¦
```javascript
width={900}  // ä» 700 å¢åŠ åˆ° 900ï¼Œæ›´å¥½åœ°å±•ç¤ºå†…å®¹
```

### æå–æ–‡æœ¬å®¹å™¨æ ·å¼
```javascript
{
  maxHeight: '60vh',      // æœ€å¤§é«˜åº¦ä¸ºè§†å£çš„ 60%
  overflowY: 'auto',      // è¶…å‡ºæ»šåŠ¨
  padding: '16px',
  backgroundColor: '#fafafa',  // æµ…ç°è‰²èƒŒæ™¯
  borderRadius: '4px'
}
```

## âœ… æµ‹è¯•å»ºè®®

### 1. åŸºæœ¬åŠŸèƒ½æµ‹è¯•
- [ ] ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"èƒ½æ­£å¸¸æ‰“å¼€å¯¹è¯æ¡†
- [ ] åŸºæœ¬ä¿¡æ¯ Tab æ˜¾ç¤ºæ­£ç¡®
- [ ] æå–æ–‡æœ¬ Tab èƒ½æ­£å¸¸åˆ‡æ¢

### 2. æ•°æ®çŠ¶æ€æµ‹è¯•
- [ ] å·²æå–çš„æ–‡æ¡£æ˜¾ç¤ºæå–å†…å®¹
- [ ] æœªæå–çš„æ–‡æ¡£æ˜¾ç¤º"å°šæœªæå–"æç¤º
- [ ] åŠ è½½ä¸­æ˜¾ç¤º Spin åŠ¨ç”»
- [ ] ç½‘ç»œé”™è¯¯æ˜¾ç¤ºé”™è¯¯æç¤º

### 3. Markdown æ¸²æŸ“æµ‹è¯•
- [ ] æ ‡é¢˜æ­£ç¡®æ¸²æŸ“
- [ ] ä»£ç å—æ­£ç¡®é«˜äº®
- [ ] åˆ—è¡¨æ­£ç¡®æ˜¾ç¤º
- [ ] è¡¨æ ¼æ­£ç¡®æ˜¾ç¤º
- [ ] é“¾æ¥å¯ç‚¹å‡»

### 4. äº¤äº’æµ‹è¯•
- [ ] æ»šåŠ¨æ¡æ­£å¸¸å·¥ä½œ
- [ ] å…³é—­å¯¹è¯æ¡†æ¸…ç©ºæ•°æ®
- [ ] é‡æ–°æ‰“å¼€é‡æ–°åŠ è½½

## ğŸ‰ æ€»ç»“

### å®ç°çš„åŠŸèƒ½
âœ… åœ¨æ–‡æ¡£æµè§ˆå™¨ä¸­ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"
âœ… è‡ªåŠ¨ä»åç«¯è·å–æå–çš„æ–‡æœ¬å†…å®¹
âœ… ä½¿ç”¨ MarkdownRenderer ç»„ä»¶æ¸²æŸ“å±•ç¤º
âœ… å®Œå–„çš„åŠ è½½ã€é”™è¯¯ã€ç©ºçŠ¶æ€å¤„ç†
âœ… æ”¯æŒä¸­è‹±æ–‡å›½é™…åŒ–
âœ… è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒ

### æŠ€æœ¯äº®ç‚¹
- ğŸ¯ å¤ç”¨å·²å°è£…çš„ MarkdownRenderer ç»„ä»¶
- ğŸ¯ ä½¿ç”¨ Tabs ç»„ç»‡å†…å®¹ï¼Œç•Œé¢æ¸…æ™°
- ğŸ¯ å®Œå–„çš„çŠ¶æ€ç®¡ç†å’Œé”™è¯¯å¤„ç†
- ğŸ¯ è‡ªåŠ¨åŠ è½½å’Œæ¸…ç†æœºåˆ¶
- ğŸ¯ å›½é™…åŒ–æ”¯æŒ

---

**å®ç°æ—¶é—´**: 2025-12-25  
**å®ç°äººå‘˜**: OmniAgent Team  
**çŠ¶æ€**: âœ… **å®Œæˆ**

ğŸ‰ **æ–‡æ¡£æµè§ˆå™¨"æŸ¥çœ‹è¯¦æƒ…"åŠŸèƒ½å·²å¢å¼ºï¼Œå¯ä»¥å®Œç¾å±•ç¤º Markdown æ ¼å¼çš„æå–æ–‡æœ¬ï¼**

