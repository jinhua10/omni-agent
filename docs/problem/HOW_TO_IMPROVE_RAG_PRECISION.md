# ğŸ¯ åˆ©ç”¨OmniAgentæ¶æ„æé«˜RAGç²¾åº¦

**æ–‡æ¡£ç±»å‹**: é—®é¢˜è§£å†³æ–¹æ¡ˆ  
**åˆ›å»ºæ—¶é—´**: 2025-12-15  
**é€‚ç”¨åœºæ™¯**: RAGæ£€ç´¢å¢å¼ºç”Ÿæˆä¼˜åŒ–

---

## ğŸ“‹ é—®é¢˜æè¿°

### æ ¸å¿ƒé—®é¢˜
å¦‚ä½•åˆ©ç”¨OmniAgentçš„ä¸ƒç»´å¯æ’æ‹”æ¶æ„ï¼Œç‰¹åˆ«æ˜¯PPLï¼ˆPrompt Programming Languageï¼‰å’ŒHOPEç³»ç»Ÿï¼Œæ¥æé«˜RAGï¼ˆRetrieval-Augmented Generationï¼‰çš„æ£€ç´¢ç²¾åº¦å’Œç­”æ¡ˆè´¨é‡ï¼Ÿ

### å…³é”®æŒ‘æˆ˜
1. **æ£€ç´¢ç²¾åº¦ä½** - ä¼ ç»ŸRAGéš¾ä»¥ç†è§£ç”¨æˆ·æ„å›¾
2. **ä¸Šä¸‹æ–‡ä¸¢å¤±** - å¤šè½®å¯¹è¯ä¸­ä¸¢å¤±å…³é”®ä¿¡æ¯
3. **çŸ¥è¯†åˆ†æ•£** - ä¸åŒç±»å‹çŸ¥è¯†æ··æ‚ï¼Œéš¾ä»¥ç²¾å‡†åŒ¹é…
4. **æç¤ºè¯è´¨é‡** - æ‰‹å·¥ç¼–å†™æç¤ºè¯æ•ˆç‡ä½ä¸”è´¨é‡ä¸ç¨³å®š

### 10ç§ä¼˜åŒ–æ–¹æ³•æ¦‚è§ˆ

| åºå· | æ–¹æ³• | ç²¾åº¦æå‡ | éš¾åº¦ | ä¼˜å…ˆçº§ |
|------|------|----------|------|--------|
| 1 | PPLæç¤ºè¯ä¼˜åŒ– | +20-25% | ä¸­ | â­â­â­ å¿…é€‰ |
| 2 | æ™ºèƒ½æ–‡æ¡£åˆ†å— | +15-20% | ä½ | â­â­â­ å¿…é€‰ |
| 3 | æ··åˆæ£€ç´¢ç­–ç•¥ | +15-18% | ä¸­ | â­â­â­ å¿…é€‰ |
| 4 | HOPEæ™ºèƒ½è·¯ç”± | +25-30% | ä¸­ | â­â­â­ æ¨è |
| 5 | æŸ¥è¯¢æ‰©å±•æ”¹å†™ | +10-15% | ä½ | â­â­ æ¨è |
| 6 | è¡Œä¸ºåˆ†æå¢å¼º | +12-15% | é«˜ | â­â­ å¯é€‰ |
| 7 | è¯­ä¹‰é‡æ’åº | +8-12% | ä¸­ | â­â­ æ¨è |
| 8 | å¤šæ¨¡å‹æŠ•ç¥¨ | +20-30% | ä¸­ | â­â­â­ æ¨è |
| 9 | å…ƒæ•°æ®è¿‡æ»¤ | +15-20% | ä½ | â­â­ æ¨è |
| 10 | çŸ¥è¯†å›¾è°±å¢å¼º | +18-25% | é«˜ | â­â­ å¯é€‰ |

**ç»„åˆä½¿ç”¨å¯è¾¾åˆ°**: æ£€ç´¢ç²¾åº¦85-95%ï¼Œç­”æ¡ˆå‡†ç¡®ç‡88-95%

---

## ğŸ—ï¸ OmniAgentæ¶æ„ä¼˜åŠ¿

### ä¸ƒç»´å¯æ’æ‹”æ¶æ„
```
1. Persistence     - é—®é¢˜åˆ†ç±»æŒä¹…åŒ–ï¼ˆ6ç§å®ç°ï¼‰
2. DocumentStorage - æ–‡æ¡£/å›¾åƒ/PPLå­˜å‚¨ï¼ˆ6ç§å®ç°ï¼‰
3. RAG            - æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆ6ç§å®ç°ï¼‰
4. AI             - LLMæœåŠ¡ï¼ˆ2ç§å®ç°ï¼‰
5. P2P            - ç‚¹å¯¹ç‚¹åä½œï¼ˆ6ç§å®ç°ï¼‰
6. Voting         - å¤šæ¨¡å‹æŠ•ç¥¨ï¼ˆ4ç§å®ç°ï¼‰
7. Behavior       - è¡Œä¸ºåˆ†æï¼ˆ3ç§å®ç°ï¼‰

æ€»ç»„åˆ: 31,104ç§ = 6Ã—6Ã—6Ã—2Ã—6Ã—4Ã—3
```

### æ ¸å¿ƒä¼˜åŠ¿
- âœ… **HOPEä¸‰å±‚çŸ¥è¯†ç®¡ç†** - æŒ‰é¢‘ç‡åˆ†å±‚å­˜å‚¨
- âœ… **PPLæ™ºèƒ½æç¤ºè¯** - ç¨‹åºåŒ–ç”Ÿæˆé«˜è´¨é‡æç¤º
- âœ… **è¡Œä¸ºåˆ†æå¼•æ“** - ç†è§£ç”¨æˆ·çœŸå®æ„å›¾
- âœ… **å¤šæ¨¡å‹æŠ•ç¥¨** - æé«˜ç­”æ¡ˆå¯é æ€§
- âœ… **çŸ¥è¯†æ¼”åŒ–è¿½è¸ª** - æŒç»­ä¼˜åŒ–çŸ¥è¯†åº“

---

## ğŸ’¡ è§£å†³æ–¹æ¡ˆæ¶æ„

### æ•´ä½“æµç¨‹
```
ç”¨æˆ·é—®é¢˜
    â†“
[1. é—®é¢˜åˆ†ç±»] â† QuestionClassifier
    â†“
[2. HOPEè·¯ç”±] â† ä¸‰å±‚çŸ¥è¯†æ£€ç´¢
    â†“
[3. PPLç”Ÿæˆ] â† PPLStorageService
    â†“
[4. RAGæ£€ç´¢] â† RAGService + ä¼˜åŒ–æç¤ºè¯
    â†“
[5. å¤šæ¨¡å‹] â† VotingArbiter + AIæœåŠ¡
    â†“
[6. è¡Œä¸ºåˆ†æ] â† BehaviorAnalysisService
    â†“
ç²¾å‡†ç­”æ¡ˆ + æŒç»­å­¦ä¹ 
```

---

## ğŸ”‘ å…³é”®æŠ€æœ¯è¯¦è§£

### 1. PPLï¼ˆPrompt Programming Languageï¼‰æé«˜æ£€ç´¢ç²¾åº¦

#### ä»€ä¹ˆæ˜¯PPL
PPLæ˜¯ä¸€ç§ç¨‹åºåŒ–ç”Ÿæˆé«˜è´¨é‡æç¤ºè¯çš„æœºåˆ¶ï¼Œå°†æç¤ºè¯ä½œä¸º"ä»£ç "è¿›è¡Œå­˜å‚¨ã€ç®¡ç†å’Œä¼˜åŒ–ã€‚

#### PPLæ¶æ„
```java
// PPLå­˜å‚¨æœåŠ¡
top.yumbo.ai.omni.core.ppl.PPLStorageService

// PPLæ•°æ®æ¨¡å‹
model.top.yumbo.ai.omni.storage.api.PPLData
â”œâ”€â”€ documentId: String      - æ–‡æ¡£ID
â”œâ”€â”€ analyzedAt: Long        - åˆ†ææ—¶é—´
â”œâ”€â”€ metadata: Map          - å…ƒæ•°æ®
â””â”€â”€ æ”¯æŒ6ç§å­˜å‚¨åç«¯: File/MongoDB/Redis/ES/S3/MinIO
```

#### PPLåº”ç”¨åœºæ™¯

**åœºæ™¯1: åŠ¨æ€æç¤ºè¯ä¼˜åŒ–**
```java
@Service
public class RAGOptimizationService {
    
    @Autowired
    private PPLStorageService pplStorage;
    
    @Autowired
    private RAGService ragService;
    
    @Autowired
    private AIService aiService;
    
    /**
     * ä½¿ç”¨PPLä¼˜åŒ–RAGæ£€ç´¢
     */
    public String queryWithPPL(String userQuestion, String sessionId) {
        // 1. æ ¹æ®é—®é¢˜ç±»å‹åŠ è½½PPLæ¨¡æ¿
        String questionType = classifyQuestion(userQuestion);
        Optional<PPLData> pplTemplate = pplStorage.getPPLData(questionType);
        
        // 2. ç”Ÿæˆä¼˜åŒ–çš„æ£€ç´¢æç¤ºè¯
        String optimizedPrompt = generateOptimizedPrompt(
            userQuestion, 
            pplTemplate
        );
        
        // 3. ä½¿ç”¨ä¼˜åŒ–æç¤ºè¯è¿›è¡ŒRAGæ£€ç´¢
        List<SearchResult> results = ragService.search(
            optimizedPrompt,  // ä½¿ç”¨PPLä¼˜åŒ–çš„æç¤ºè¯
            10
        );
        
        // 4. æ„å»ºä¸Šä¸‹æ–‡å¢å¼ºçš„AIæç¤º
        String contextPrompt = buildContextPrompt(results, pplTemplate);
        
        // 5. ç”Ÿæˆç­”æ¡ˆ
        AIResponse response = aiService.chat(contextPrompt);
        
        return response.getContent();
    }
    
    /**
     * ç”Ÿæˆä¼˜åŒ–çš„æ£€ç´¢æç¤ºè¯
     */
    private String generateOptimizedPrompt(
        String question, 
        Optional<PPLData> pplTemplate
    ) {
        if (pplTemplate.isEmpty()) {
            return question;  // æ²¡æœ‰æ¨¡æ¿ï¼Œä½¿ç”¨åŸé—®é¢˜
        }
        
        // PPLæ¨¡æ¿ç¤ºä¾‹:
        // "æ£€ç´¢å…³é”®è¯: {keywords}
        //  ä¸Šä¸‹æ–‡ç±»å‹: {contextType}
        //  æ—¶é—´èŒƒå›´: {timeRange}
        //  ç›¸å…³åº¦é˜ˆå€¼: {threshold}"
        
        return applyPPLTemplate(question, pplTemplate.get());
    }
}
```

**åœºæ™¯2: é¢†åŸŸç‰¹å®šPPLæ¨¡æ¿**
```java
/**
 * æŠ€æœ¯é—®é¢˜PPLæ¨¡æ¿
 */
public class TechnicalPPLTemplate {
    
    public void saveTechnicalTemplate() {
        String technicalPPL = """
            {
              "type": "technical_question",
              "retrieval_strategy": {
                "keywords_extraction": "extract_technical_terms",
                "context_expansion": true,
                "code_snippet_priority": "high",
                "api_documentation_weight": 0.8
              },
              "prompt_template": "
                æ£€ç´¢æŠ€æœ¯æ–‡æ¡£æ—¶è¯·å…³æ³¨:
                1. ä»£ç ç¤ºä¾‹å’ŒAPIä½¿ç”¨æ–¹æ³•
                2. é”™è¯¯ä¿¡æ¯å’Œè§£å†³æ–¹æ¡ˆ
                3. æœ€ä½³å®è·µå’Œæ€§èƒ½ä¼˜åŒ–
                4. ç‰ˆæœ¬å…¼å®¹æ€§è¯´æ˜
                
                ç”¨æˆ·é—®é¢˜: {question}
                æ£€ç´¢å…³é”®è¯: {keywords}
                æŠ€æœ¯æ ˆ: {tech_stack}
              "
            }
            """;
        
        pplStorage.savePPLData(
            "technical_question",
            technicalPPL,
            "Technical question PPL template"
        );
    }
}

/**
 * ä¸šåŠ¡é—®é¢˜PPLæ¨¡æ¿
 */
public class BusinessPPLTemplate {
    
    public void saveBusinessTemplate() {
        String businessPPL = """
            {
              "type": "business_question",
              "retrieval_strategy": {
                "keywords_extraction": "extract_business_entities",
                "context_expansion": true,
                "policy_document_priority": "high",
                "regulation_weight": 0.9
              },
              "prompt_template": "
                æ£€ç´¢ä¸šåŠ¡æ–‡æ¡£æ—¶è¯·å…³æ³¨:
                1. ä¸šåŠ¡è§„åˆ™å’Œæ”¿ç­–
                2. æµç¨‹è¯´æ˜å’Œæ“ä½œæŒ‡å—
                3. åˆè§„è¦æ±‚å’Œæ³•è§„
                4. å†å²æ¡ˆä¾‹å’Œç»éªŒ
                
                ç”¨æˆ·é—®é¢˜: {question}
                ä¸šåŠ¡åœºæ™¯: {scenario}
                ç›¸å…³éƒ¨é—¨: {departments}
              "
            }
            """;
        
        pplStorage.savePPLData(
            "business_question",
            businessPPL,
            "Business question PPL template"
        );
    }
}
```

---

### 2. æ–‡æ¡£åˆ†å—ä¼˜åŒ–ï¼ˆDocument Chunkingï¼‰æé«˜æ£€ç´¢ç²¾åº¦

#### ä»€ä¹ˆæ˜¯æ–‡æ¡£åˆ†å—
æ–‡æ¡£åˆ†å—æ˜¯å°†é•¿æ–‡æ¡£åˆ‡åˆ†æˆå°å—çš„è¿‡ç¨‹ï¼Œåˆç†çš„åˆ†å—ç­–ç•¥å¯ä»¥æ˜¾è‘—æé«˜RAGçš„æ£€ç´¢ç²¾åº¦å’Œç­”æ¡ˆè´¨é‡ã€‚

#### åˆ†å—æ¶æ„
```java
// æ–‡æ¡£åˆ†å—æœåŠ¡
top.yumbo.ai.omni.core.chunking.DocumentChunkingService

// åˆ†å—æ¨¡å‹
model.top.yumbo.ai.omni.storage.api.Chunk
â”œâ”€â”€ chunkId: String        - åˆ†å—ID
â”œâ”€â”€ documentId: String     - æ–‡æ¡£ID
â”œâ”€â”€ content: String        - åˆ†å—å†…å®¹
â”œâ”€â”€ chunkIndex: Integer    - åˆ†å—ç´¢å¼•
â”œâ”€â”€ metadata: Map          - å…ƒæ•°æ®ï¼ˆæ ‡é¢˜ã€ç« èŠ‚ç­‰ï¼‰
â””â”€â”€ vector: float[]        - å‘é‡è¡¨ç¤ºï¼ˆå¯é€‰ï¼‰
```

#### æ™ºèƒ½åˆ†å—ç­–ç•¥

**ç­–ç•¥1: è¯­ä¹‰æ„ŸçŸ¥åˆ†å—**
```java
@Service
public class SemanticChunkingService {
    
    @Autowired
    private DocumentChunkingService chunkingService;
    
    @Autowired
    private EmbeddingService embeddingService;
    
    /**
     * åŸºäºè¯­ä¹‰çš„æ™ºèƒ½åˆ†å—
     */
    public List<Chunk> semanticChunking(String documentId, String content) {
        // 1. æŒ‰æ®µè½åˆæ­¥åˆ†å—
        List<String> paragraphs = splitByParagraph(content);
        
        // 2. è®¡ç®—æ®µè½é—´çš„è¯­ä¹‰ç›¸ä¼¼åº¦
        List<float[]> vectors = paragraphs.stream()
            .map(embeddingService::embed)
            .collect(Collectors.toList());
        
        // 3. åˆå¹¶è¯­ä¹‰ç›¸è¿‘çš„æ®µè½
        List<Chunk> chunks = new ArrayList<>();
        StringBuilder currentChunk = new StringBuilder();
        int chunkIndex = 0;
        
        for (int i = 0; i < paragraphs.size(); i++) {
            currentChunk.append(paragraphs.get(i)).append("\n");
            
            // æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ†å—
            boolean shouldSplit = false;
            if (i < paragraphs.size() - 1) {
                double similarity = cosineSimilarity(
                    vectors.get(i), 
                    vectors.get(i + 1)
                );
                // è¯­ä¹‰ç›¸ä¼¼åº¦ä½äºé˜ˆå€¼ï¼Œåˆ†å—
                shouldSplit = similarity < 0.7;
            }
            
            if (shouldSplit || currentChunk.length() > 1000) {
                chunks.add(createChunk(
                    documentId, 
                    currentChunk.toString(), 
                    chunkIndex++
                ));
                currentChunk = new StringBuilder();
            }
        }
        
        // å­˜å‚¨åˆ†å—
        return chunkingService.saveChunks(documentId, chunks);
    }
}
```

**ç­–ç•¥2: ç»“æ„åŒ–åˆ†å—**
```java
/**
 * åŸºäºæ–‡æ¡£ç»“æ„çš„åˆ†å—
 */
public class StructuredChunkingService {
    
    /**
     * Markdownæ–‡æ¡£ç»“æ„åŒ–åˆ†å—
     */
    public List<Chunk> chunkMarkdown(String documentId, String markdown) {
        List<Chunk> chunks = new ArrayList<>();
        
        // 1. è§£æMarkdownç»“æ„
        MarkdownParser parser = new MarkdownParser();
        Document doc = parser.parse(markdown);
        
        // 2. æŒ‰æ ‡é¢˜å±‚çº§åˆ†å—
        int chunkIndex = 0;
        for (Section section : doc.getSections()) {
            String chunkContent = buildSectionContent(section);
            
            Chunk chunk = Chunk.builder()
                .chunkId(UUID.randomUUID().toString())
                .documentId(documentId)
                .content(chunkContent)
                .chunkIndex(chunkIndex++)
                .metadata(Map.of(
                    "title", section.getTitle(),
                    "level", section.getLevel(),
                    "parent", section.getParent()
                ))
                .build();
            
            chunks.add(chunk);
        }
        
        return chunks;
    }
    
    /**
     * ä»£ç æ–‡æ¡£åˆ†å—ï¼ˆä¿æŒä»£ç å®Œæ•´æ€§ï¼‰
     */
    public List<Chunk> chunkCodeDocument(String documentId, String code) {
        List<Chunk> chunks = new ArrayList<>();
        
        // æŒ‰å‡½æ•°/ç±»åˆ†å—ï¼Œä¿æŒä»£ç å®Œæ•´æ€§
        CodeParser parser = new CodeParser();
        List<CodeBlock> blocks = parser.parseCodeBlocks(code);
        
        int chunkIndex = 0;
        for (CodeBlock block : blocks) {
            Chunk chunk = Chunk.builder()
                .chunkId(UUID.randomUUID().toString())
                .documentId(documentId)
                .content(block.getCode())
                .chunkIndex(chunkIndex++)
                .metadata(Map.of(
                    "type", block.getType(), // function/class/method
                    "name", block.getName(),
                    "language", block.getLanguage()
                ))
                .build();
            
            chunks.add(chunk);
        }
        
        return chunks;
    }
}
```

**ç­–ç•¥3: é‡å åˆ†å—ï¼ˆOverlapping Chunksï¼‰**
```java
/**
 * é‡å åˆ†å—æé«˜ä¸Šä¸‹æ–‡è¿ç»­æ€§
 */
public List<Chunk> overlappingChunking(
    String documentId, 
    String content,
    int chunkSize,    // åˆ†å—å¤§å°ï¼š500å­—
    int overlapSize   // é‡å å¤§å°ï¼š100å­—
) {
    List<Chunk> chunks = new ArrayList<>();
    int position = 0;
    int chunkIndex = 0;
    
    while (position < content.length()) {
        int end = Math.min(position + chunkSize, content.length());
        String chunkContent = content.substring(position, end);
        
        Chunk chunk = Chunk.builder()
            .chunkId(UUID.randomUUID().toString())
            .documentId(documentId)
            .content(chunkContent)
            .chunkIndex(chunkIndex++)
            .metadata(Map.of(
                "startPos", position,
                "endPos", end,
                "hasOverlap", position > 0
            ))
            .build();
        
        chunks.add(chunk);
        
        // ç§»åŠ¨ä½ç½®ï¼Œä¿ç•™é‡å éƒ¨åˆ†
        position += (chunkSize - overlapSize);
    }
    
    return chunks;
}
```

---

### 3. å‘é‡æ£€ç´¢ä¼˜åŒ–ï¼ˆEmbedding Optimizationï¼‰

#### æ··åˆæ£€ç´¢ç­–ç•¥
```java
@Service
public class HybridRetrievalService {
    
    @Autowired
    private RAGService ragService;
    
    @Autowired
    private EmbeddingService embeddingService;
    
    /**
     * æ··åˆæ£€ç´¢ï¼šå‘é‡æ£€ç´¢ + å…³é”®è¯æ£€ç´¢ + è¯­ä¹‰é‡æ’åº
     */
    public List<SearchResult> hybridSearch(String question, int topK) {
        // 1. å‘é‡æ£€ç´¢ï¼ˆè¯­ä¹‰ç›¸ä¼¼åº¦ï¼‰
        float[] queryVector = embeddingService.embed(question);
        List<SearchResult> vectorResults = ragService.vectorSearch(
            queryVector, 
            topK * 2  // å–2å€ç»“æœç”¨äºé‡æ’åº
        );
        
        // 2. å…³é”®è¯æ£€ç´¢ï¼ˆBM25ï¼‰
        List<SearchResult> keywordResults = ragService.keywordSearch(
            question, 
            topK * 2
        );
        
        // 3. ç»“æœèåˆï¼ˆReciprocal Rank Fusionï¼‰
        Map<String, Double> fusedScores = reciprocalRankFusion(
            vectorResults, 
            keywordResults
        );
        
        // 4. è¯­ä¹‰é‡æ’åºï¼ˆRerankingï¼‰
        List<SearchResult> rerankedResults = semanticReranking(
            question,
            fusedScores,
            topK
        );
        
        return rerankedResults;
    }
    
    /**
     * å€’æ•°æ’åèåˆï¼ˆRRFï¼‰
     */
    private Map<String, Double> reciprocalRankFusion(
        List<SearchResult> list1,
        List<SearchResult> list2
    ) {
        Map<String, Double> scores = new HashMap<>();
        int k = 60;  // RRFå¸¸æ•°
        
        // è®¡ç®—list1çš„RRFåˆ†æ•°
        for (int i = 0; i < list1.size(); i++) {
            String docId = list1.get(i).getDocumentId();
            scores.merge(docId, 1.0 / (k + i + 1), Double::sum);
        }
        
        // è®¡ç®—list2çš„RRFåˆ†æ•°
        for (int i = 0; i < list2.size(); i++) {
            String docId = list2.get(i).getDocumentId();
            scores.merge(docId, 1.0 / (k + i + 1), Double::sum);
        }
        
        return scores;
    }
    
    /**
     * è¯­ä¹‰é‡æ’åº
     */
    private List<SearchResult> semanticReranking(
        String question,
        Map<String, Double> candidateScores,
        int topK
    ) {
        // ä½¿ç”¨æ›´å¼ºå¤§çš„æ¨¡å‹é‡æ–°è®¡ç®—ç›¸å…³åº¦
        return candidateScores.entrySet().stream()
            .map(entry -> {
                String docId = entry.getKey();
                double baseScore = entry.getValue();
                
                // é‡æ–°è®¡ç®—è¯­ä¹‰ç›¸å…³åº¦
                double semanticScore = calculateSemanticRelevance(
                    question, 
                    docId
                );
                
                // èåˆåˆ†æ•°
                double finalScore = baseScore * 0.6 + semanticScore * 0.4;
                
                return new SearchResult(docId, finalScore);
            })
            .sorted(Comparator.comparing(SearchResult::getScore).reversed())
            .limit(topK)
            .collect(Collectors.toList());
    }
}
```

#### å¤šæ¨¡æ€å‘é‡æ£€ç´¢
```java
/**
 * æ”¯æŒæ–‡æœ¬+å›¾åƒçš„å¤šæ¨¡æ€æ£€ç´¢
 */
@Service
public class MultiModalRetrievalService {
    
    @Autowired
    private EmbeddingService textEmbedding;
    
    @Autowired
    private ImageStorageService imageStorage;
    
    /**
     * å¤šæ¨¡æ€æ£€ç´¢
     */
    public List<SearchResult> multiModalSearch(
        String textQuery,
        byte[] imageQuery,
        int topK
    ) {
        List<SearchResult> results = new ArrayList<>();
        
        // 1. æ–‡æœ¬å‘é‡æ£€ç´¢
        if (textQuery != null && !textQuery.isEmpty()) {
            float[] textVector = textEmbedding.embed(textQuery);
            results.addAll(vectorSearch(textVector, topK));
        }
        
        // 2. å›¾åƒå‘é‡æ£€ç´¢
        if (imageQuery != null && imageQuery.length > 0) {
            float[] imageVector = embedImage(imageQuery);
            results.addAll(vectorSearch(imageVector, topK));
        }
        
        // 3. èåˆå¤šæ¨¡æ€ç»“æœ
        return fuseMultiModalResults(results, topK);
    }
}
```

---

### 4. æŸ¥è¯¢æ‰©å±•ä¸æ”¹å†™ï¼ˆQuery Expansion & Rewritingï¼‰

#### æŸ¥è¯¢æ‰©å±•
```java
@Service
public class QueryExpansionService {
    
    @Autowired
    private AIService aiService;
    
    @Autowired
    private RAGService ragService;
    
    /**
     * HyDEæŸ¥è¯¢æ‰©å±•ï¼ˆHypothetical Document Embeddingsï¼‰
     */
    public List<SearchResult> hydeSearch(String question, int topK) {
        // 1. è®©LLMç”Ÿæˆå‡è®¾æ€§æ–‡æ¡£
        String hypotheticalDoc = aiService.chat(
            "è¯·ç”Ÿæˆä¸€ä¸ªèƒ½å¤Ÿå›ç­”ä»¥ä¸‹é—®é¢˜çš„å‡è®¾æ€§æ–‡æ¡£ï¼š\n" + question
        ).getContent();
        
        // 2. ä½¿ç”¨å‡è®¾æ€§æ–‡æ¡£è¿›è¡Œæ£€ç´¢
        List<SearchResult> results = ragService.search(
            hypotheticalDoc,  // ç”¨ç”Ÿæˆçš„æ–‡æ¡£è€Œä¸æ˜¯åŸé—®é¢˜æ£€ç´¢
            topK
        );
        
        return results;
    }
    
    /**
     * å¤šæŸ¥è¯¢æ‰©å±•ï¼ˆMulti-Query Expansionï¼‰
     */
    public List<SearchResult> multiQuerySearch(String question, int topK) {
        // 1. ç”Ÿæˆå¤šä¸ªå˜ä½“æŸ¥è¯¢
        List<String> expandedQueries = generateQueryVariants(question);
        
        // 2. å¯¹æ¯ä¸ªæŸ¥è¯¢è¿›è¡Œæ£€ç´¢
        Map<String, SearchResult> allResults = new HashMap<>();
        for (String query : expandedQueries) {
            List<SearchResult> results = ragService.search(query, topK);
            for (SearchResult result : results) {
                allResults.merge(
                    result.getDocumentId(),
                    result,
                    (r1, r2) -> r1.getScore() > r2.getScore() ? r1 : r2
                );
            }
        }
        
        // 3. è¿”å›èšåˆç»“æœ
        return allResults.values().stream()
            .sorted(Comparator.comparing(SearchResult::getScore).reversed())
            .limit(topK)
            .collect(Collectors.toList());
    }
    
    /**
     * ç”ŸæˆæŸ¥è¯¢å˜ä½“
     */
    private List<String> generateQueryVariants(String question) {
        String prompt = """
            è¯·å°†ä»¥ä¸‹é—®é¢˜æ”¹å†™æˆ5ä¸ªä¸åŒçš„è¡¨è¾¾æ–¹å¼ï¼Œä¿æŒåŸæ„ï¼š
            
            åŸé—®é¢˜ï¼š%s
            
            è¯·åªè¿”å›5ä¸ªæ”¹å†™çš„é—®é¢˜ï¼Œæ¯è¡Œä¸€ä¸ªã€‚
            """.formatted(question);
        
        String response = aiService.chat(prompt).getContent();
        return Arrays.asList(response.split("\n"))
            .stream()
            .map(String::trim)
            .filter(s -> !s.isEmpty())
            .collect(Collectors.toList());
    }
}
```

#### æŸ¥è¯¢åˆ†è§£
```java
/**
 * å°†å¤æ‚æŸ¥è¯¢åˆ†è§£ä¸ºå­æŸ¥è¯¢
 */
public class QueryDecompositionService {
    
    /**
     * åˆ†è§£å¤æ‚é—®é¢˜
     */
    public String decomposeAndQuery(String complexQuestion) {
        // 1. åˆ†è§£ä¸ºå­é—®é¢˜
        List<String> subQuestions = decomposeQuestion(complexQuestion);
        
        // 2. ä¾æ¬¡å›ç­”å­é—®é¢˜
        StringBuilder finalAnswer = new StringBuilder();
        Map<String, String> subAnswers = new HashMap<>();
        
        for (String subQ : subQuestions) {
            // æ£€ç´¢å¹¶å›ç­”å­é—®é¢˜
            List<SearchResult> results = ragService.search(subQ, 5);
            String subAnswer = generateAnswer(subQ, results);
            subAnswers.put(subQ, subAnswer);
        }
        
        // 3. ç»¼åˆæ‰€æœ‰å­ç­”æ¡ˆ
        String synthesizedAnswer = synthesizeAnswers(
            complexQuestion,
            subAnswers
        );
        
        return synthesizedAnswer;
    }
    
    /**
     * åˆ†è§£é—®é¢˜
     */
    private List<String> decomposeQuestion(String question) {
        String prompt = """
            è¯·å°†ä»¥ä¸‹å¤æ‚é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªç®€å•çš„å­é—®é¢˜ï¼š
            
            é—®é¢˜ï¼š%s
            
            è¯·è¿”å›å­é—®é¢˜åˆ—è¡¨ï¼Œæ¯è¡Œä¸€ä¸ªã€‚
            """.formatted(question);
        
        String response = aiService.chat(prompt).getContent();
        return Arrays.asList(response.split("\n"));
    }
}
```

---

### 5. å…ƒæ•°æ®è¿‡æ»¤ï¼ˆMetadata Filteringï¼‰

#### æ™ºèƒ½è¿‡æ»¤ç­–ç•¥
```java
@Service
public class MetadataFilteringService {
    
    @Autowired
    private RAGService ragService;
    
    /**
     * åŸºäºå…ƒæ•°æ®çš„ç²¾å‡†æ£€ç´¢
     */
    public List<SearchResult> searchWithMetadata(
        String question,
        Map<String, Object> filters,
        int topK
    ) {
        // 1. æå–é—®é¢˜ä¸­çš„éšå«è¿‡æ»¤æ¡ä»¶
        Map<String, Object> implicitFilters = extractImplicitFilters(question);
        
        // 2. åˆå¹¶æ˜¾å¼å’Œéšå¼è¿‡æ»¤æ¡ä»¶
        Map<String, Object> allFilters = new HashMap<>();
        allFilters.putAll(filters);
        allFilters.putAll(implicitFilters);
        
        // 3. åº”ç”¨è¿‡æ»¤å™¨æ£€ç´¢
        return ragService.searchWithFilters(question, allFilters, topK);
    }
    
    /**
     * æå–éšå«çš„è¿‡æ»¤æ¡ä»¶
     */
    private Map<String, Object> extractImplicitFilters(String question) {
        Map<String, Object> filters = new HashMap<>();
        
        // æå–æ—¶é—´èŒƒå›´
        if (question.contains("æœ€è¿‘") || question.contains("è¿‘æœŸ")) {
            long oneMonthAgo = System.currentTimeMillis() - 30L * 24 * 3600 * 1000;
            filters.put("timestamp_gte", oneMonthAgo);
        }
        
        // æå–æ–‡æ¡£ç±»å‹
        if (question.contains("APIæ–‡æ¡£") || question.contains("æ¥å£æ–‡æ¡£")) {
            filters.put("doc_type", "api");
        } else if (question.contains("æ•™ç¨‹") || question.contains("æŒ‡å—")) {
            filters.put("doc_type", "tutorial");
        }
        
        // æå–è¯­è¨€
        if (question.contains("Java") || question.contains("java")) {
            filters.put("language", "java");
        } else if (question.contains("Python") || question.contains("python")) {
            filters.put("language", "python");
        }
        
        // æå–ç‰ˆæœ¬ä¿¡æ¯
        Pattern versionPattern = Pattern.compile("(\\d+\\.\\d+(\\.\\d+)?)");
        Matcher matcher = versionPattern.matcher(question);
        if (matcher.find()) {
            filters.put("version", matcher.group(1));
        }
        
        return filters;
    }
}
```

---

### 6. ä¸Šä¸‹æ–‡çª—å£ä¼˜åŒ–ï¼ˆContext Window Managementï¼‰

#### æ™ºèƒ½ä¸Šä¸‹æ–‡é€‰æ‹©
```java
@Service
public class ContextWindowOptimizer {
    
    /**
     * ä¼˜åŒ–ä¸Šä¸‹æ–‡çª—å£å¤§å°
     */
    public String optimizeContext(
        String question,
        List<SearchResult> allResults,
        int maxTokens
    ) {
        // 1. è®¡ç®—æ¯ä¸ªç»“æœçš„ç›¸å…³åº¦å’Œé‡è¦æ€§
        List<ScoredChunk> scoredChunks = allResults.stream()
            .map(result -> new ScoredChunk(
                result,
                calculateRelevance(question, result),
                calculateImportance(result)
            ))
            .sorted(Comparator.comparing(ScoredChunk::getScore).reversed())
            .collect(Collectors.toList());
        
        // 2. åŠ¨æ€é€‰æ‹©æœ€ä½³ä¸Šä¸‹æ–‡
        StringBuilder context = new StringBuilder();
        int currentTokens = 0;
        
        for (ScoredChunk chunk : scoredChunks) {
            int chunkTokens = estimateTokens(chunk.getContent());
            
            if (currentTokens + chunkTokens > maxTokens) {
                break;  // è¾¾åˆ°ä¸Šé™
            }
            
            context.append(chunk.getContent()).append("\n\n");
            currentTokens += chunkTokens;
        }
        
        return context.toString();
    }
    
    /**
     * ä¸Šä¸‹æ–‡å‹ç¼©ï¼ˆä¿ç•™å…³é”®ä¿¡æ¯ï¼‰
     */
    public String compressContext(String longContext, int targetTokens) {
        // ä½¿ç”¨LLMæå–å…³é”®ä¿¡æ¯
        String prompt = """
            è¯·ä»ä»¥ä¸‹é•¿æ–‡æœ¬ä¸­æå–æœ€å…³é”®çš„ä¿¡æ¯ï¼Œå‹ç¼©åˆ°çº¦%dä¸ªtokenï¼š
            
            %s
            
            è¯·ä¿ç•™æœ€é‡è¦çš„äº‹å®ã€æ•°æ®å’Œè§‚ç‚¹ã€‚
            """.formatted(targetTokens, longContext);
        
        return aiService.chat(prompt).getContent();
    }
}
```

---

### 7. çŸ¥è¯†å›¾è°±å¢å¼ºï¼ˆKnowledge Graph Enhancementï¼‰

#### å›¾è°±è¾…åŠ©æ£€ç´¢
```java
@Service
public class KnowledgeGraphRAGService {
    
    @Autowired
    private KnowledgeGraphService kgService;
    
    @Autowired
    private RAGService ragService;
    
    /**
     * çŸ¥è¯†å›¾è°±å¢å¼ºçš„RAG
     */
    public String queryWithKG(String question) {
        // 1. ä»é—®é¢˜ä¸­æå–å®ä½“
        List<String> entities = extractEntities(question);
        
        // 2. ä»çŸ¥è¯†å›¾è°±è·å–ç›¸å…³å­å›¾
        Graph subGraph = kgService.getSubGraph(entities, 2); // 2è·³é‚»å±…
        
        // 3. ä½¿ç”¨å­å›¾ä¿¡æ¯æ‰©å±•æŸ¥è¯¢
        String expandedQuery = expandQueryWithGraph(question, subGraph);
        
        // 4. æ‰§è¡ŒRAGæ£€ç´¢
        List<SearchResult> results = ragService.search(expandedQuery, 10);
        
        // 5. ä½¿ç”¨å›¾è°±ä¿¡æ¯å¢å¼ºç­”æ¡ˆ
        return generateAnswerWithGraph(question, results, subGraph);
    }
    
    /**
     * ä½¿ç”¨å›¾è°±æ‰©å±•æŸ¥è¯¢
     */
    private String expandQueryWithGraph(String question, Graph graph) {
        StringBuilder expanded = new StringBuilder(question);
        
        // æ·»åŠ ç›¸å…³å®ä½“å’Œå…³ç³»
        for (Node node : graph.getNodes()) {
            expanded.append(" ").append(node.getLabel());
        }
        
        for (Edge edge : graph.getEdges()) {
            expanded.append(" ").append(edge.getRelation());
        }
        
        return expanded.toString();
    }
}
```

---

### 3. HOPEä¸‰å±‚çŸ¥è¯†ç®¡ç†æé«˜æ£€ç´¢æ•ˆç‡

#### HOPEæ¶æ„
```
ğŸ“ top.yumbo.ai.omni.core.hope
â”œâ”€â”€ HOPEKnowledgeManager        - çŸ¥è¯†ç®¡ç†åè°ƒå™¨
â”œâ”€â”€ QuestionClassifier          - é—®é¢˜åˆ†ç±»å™¨
â”œâ”€â”€ layer/
â”‚   â”œâ”€â”€ HighFrequencyLayer      - é«˜é¢‘å±‚ï¼ˆä¼šè¯ä¸Šä¸‹æ–‡ï¼‰
â”‚   â”œâ”€â”€ OrdinaryLayer           - ä¸­é¢‘å±‚ï¼ˆå¸¸è§„çŸ¥è¯†ï¼‰
â”‚   â””â”€â”€ PermanentLayer          - ä½é¢‘å±‚ï¼ˆæ°¸ä¹…çŸ¥è¯†ï¼‰
â””â”€â”€ learning/
    â””â”€â”€ LearningService         - è‡ªåŠ¨å­¦ä¹ æœåŠ¡
```

#### HOPE + RAGé›†æˆ
```java
@Service
public class HOPERAGIntegrationService {
    
    @Autowired
    private HOPEKnowledgeManager hopeManager;
    
    @Autowired
    private HighFrequencyLayerService highFreqLayer;
    
    @Autowired
    private OrdinaryLayerService ordinaryLayer;
    
    @Autowired
    private PermanentLayerService permanentLayer;
    
    @Autowired
    private RAGService ragService;
    
    /**
     * HOPEå¢å¼ºçš„RAGæŸ¥è¯¢
     */
    public String queryWithHOPE(String question, String sessionId) {
        // 1. HOPEæ™ºèƒ½è·¯ç”±
        HOPEKnowledgeManager.QueryResult hopeResult = 
            hopeManager.smartQuery(question, sessionId);
        
        String suggestedLayer = hopeResult.getSuggestedLayer();
        
        // 2. æŒ‰å±‚çº§ä¼˜å…ˆçº§æ£€ç´¢
        String answer = null;
        
        switch (suggestedLayer) {
            case "HIGH_FREQUENCY":
                // é«˜é¢‘å±‚ï¼šä¼˜å…ˆæ£€æŸ¥ä¼šè¯ä¸Šä¸‹æ–‡
                answer = queryHighFrequency(question, sessionId);
                if (answer != null) return answer;
                // fallthrough
                
            case "ORDINARY":
                // ä¸­é¢‘å±‚ï¼šå¸¸è§„çŸ¥è¯†æ£€ç´¢
                answer = queryOrdinary(question);
                if (answer != null) return answer;
                // fallthrough
                
            case "PERMANENT":
                // ä½é¢‘å±‚ï¼šæ°¸ä¹…çŸ¥è¯† + RAG
                answer = queryPermanent(question);
                if (answer != null) return answer;
                break;
        }
        
        // 3. å¦‚æœä¸‰å±‚éƒ½æ²¡æ‰¾åˆ°ï¼Œä½¿ç”¨RAGå…¨æ–‡æ£€ç´¢
        return queryWithFullRAG(question, hopeResult);
    }
    
    /**
     * é«˜é¢‘å±‚æŸ¥è¯¢ï¼ˆä¼šè¯ä¸Šä¸‹æ–‡ï¼‰
     */
    private String queryHighFrequency(String question, String sessionId) {
        var result = highFreqLayer.query(sessionId, question);
        
        if (!result.isHasContext()) {
            return null;  // æ²¡æœ‰ä¸Šä¸‹æ–‡ï¼Œè·³è¿‡
        }
        
        // æœ‰ä¸Šä¸‹æ–‡ï¼Œæ„å»ºä¸Šä¸‹æ–‡å¢å¼ºçš„æ£€ç´¢
        List<String> contexts = result.getContexts();
        String contextualQuery = buildContextualQuery(question, contexts);
        
        // ä½¿ç”¨ä¸Šä¸‹æ–‡å¢å¼ºçš„æŸ¥è¯¢
        return performRAGWithContext(contextualQuery);
    }
    
    /**
     * ä¸­é¢‘å±‚æŸ¥è¯¢ï¼ˆå¸¸è§„çŸ¥è¯†ï¼‰
     */
    private String queryOrdinary(String question) {
        // ä»ä¸­é¢‘å±‚è·å–å¸¸è§„çŸ¥è¯†
        var knowledgeItems = ordinaryLayer.query(question);
        
        if (knowledgeItems.isEmpty()) {
            return null;
        }
        
        // ä½¿ç”¨å¸¸è§„çŸ¥è¯†æ„å»ºæ£€ç´¢æŸ¥è¯¢
        return performRAGWithKnowledge(question, knowledgeItems);
    }
    
    /**
     * ä½é¢‘å±‚æŸ¥è¯¢ï¼ˆæ°¸ä¹…çŸ¥è¯†ï¼‰
     */
    private String queryPermanent(String question) {
        // ä»ä½é¢‘å±‚è·å–æ°¸ä¹…çŸ¥è¯†
        var permanentKnowledge = permanentLayer.query(question);
        
        if (permanentKnowledge.isEmpty()) {
            return null;
        }
        
        // æ°¸ä¹…çŸ¥è¯†å¯ä»¥ç›´æ¥è¿”å›æˆ–ç”¨äºRAGå¢å¼º
        return permanentKnowledge.getAnswer();
    }
}
```

---

### 3. è¡Œä¸ºåˆ†ææé«˜æ„å›¾ç†è§£

#### è¡Œä¸ºåˆ†ææ¶æ„
```java
@Service
public class BehaviorEnhancedRAG {
    
    @Autowired
    private BehaviorAnalysisService behaviorService;
    
    @Autowired
    private RAGService ragService;
    
    /**
     * åŸºäºè¡Œä¸ºåˆ†æçš„æ™ºèƒ½æ£€ç´¢
     */
    public String queryWithBehaviorAnalysis(
        String question,
        String userId,
        String sessionId
    ) {
        // 1. æ¨æ–­ç”¨æˆ·æ€åº¦å’Œæ„å›¾
        AttitudeScore attitude = behaviorService.inferAttitude(
            userId,
            sessionId
        );
        
        // 2. æ ¹æ®æ€åº¦è°ƒæ•´æ£€ç´¢ç­–ç•¥
        SearchStrategy strategy = determineStrategy(attitude);
        
        // 3. æ‰§è¡Œæ™ºèƒ½æ£€ç´¢
        List<SearchResult> results = ragService.search(
            question,
            strategy.getTopK()
        );
        
        // 4. æ ¹æ®ç”¨æˆ·åå¥½æ’åºç»“æœ
        List<SearchResult> rankedResults = rankByUserPreference(
            results,
            userId,
            attitude
        );
        
        // 5. æ”¶é›†åé¦ˆä¿¡å·
        collectFeedbackSignal(userId, question, rankedResults);
        
        return generateAnswer(rankedResults);
    }
    
    /**
     * æ ¹æ®æ€åº¦ç¡®å®šæ£€ç´¢ç­–ç•¥
     */
    private SearchStrategy determineStrategy(AttitudeScore attitude) {
        AttitudeLevel level = attitude.getLevel();
        
        return switch (level) {
            case VERY_POSITIVE -> 
                // éå¸¸æ»¡æ„ï¼šè¿”å›æ›´æ·±å…¥çš„å†…å®¹
                new SearchStrategy(topK: 15, depth: "deep");
                
            case POSITIVE -> 
                // æ»¡æ„ï¼šæ ‡å‡†æ£€ç´¢
                new SearchStrategy(topK: 10, depth: "normal");
                
            case NEUTRAL -> 
                // ä¸­ç«‹ï¼šæä¾›å¤šæ ·åŒ–ç»“æœ
                new SearchStrategy(topK: 10, depth: "diverse");
                
            case NEGATIVE -> 
                // ä¸æ»¡æ„ï¼šæ›´ç²¾å‡†çš„ç»“æœ
                new SearchStrategy(topK: 5, depth: "precise");
                
            case VERY_NEGATIVE -> 
                // éå¸¸ä¸æ»¡ï¼šåˆ‡æ¢æ£€ç´¢æ–¹å¼
                new SearchStrategy(topK: 3, depth: "alternative");
        };
    }
}
```

---

### 4. å¤šæ¨¡å‹æŠ•ç¥¨æé«˜ç­”æ¡ˆå¯é æ€§

#### æŠ•ç¥¨æ¶æ„
```java
@Service
public class MultiModelRAGService {
    
    @Autowired
    private VotingArbiter votingArbiter;
    
    @Autowired
    private List<AIService> aiServices;  // å¤šä¸ªAIæœåŠ¡
    
    @Autowired
    private RAGService ragService;
    
    /**
     * å¤šæ¨¡å‹æŠ•ç¥¨RAG
     */
    public String queryWithVoting(String question) {
        // 1. RAGæ£€ç´¢è·å–ä¸Šä¸‹æ–‡
        List<SearchResult> contexts = ragService.search(question, 10);
        
        // 2. åˆ›å»ºæŠ•ç¥¨ä¼šè¯
        String sessionId = votingArbiter.createSession(
            "RAG Answer Voting",
            contexts.toString()
        );
        
        // 3. å¤šä¸ªæ¨¡å‹ç”Ÿæˆç­”æ¡ˆå¹¶æŠ•ç¥¨
        for (AIService aiService : aiServices) {
            String answer = aiService.chat(
                buildPrompt(question, contexts)
            ).getContent();
            
            // æŠ•ç¥¨
            votingArbiter.castVote(
                sessionId,
                aiService.getModelName(),
                Vote.builder()
                    .voterId(aiService.getModelName())
                    .voterType(VoterType.AI)
                    .decision(Vote.Decision.APPROVE)
                    .metadata(Map.of("answer", answer))
                    .build()
            );
        }
        
        // 4. ç»Ÿè®¡æŠ•ç¥¨ç»“æœ
        VotingResult result = votingArbiter.tallyVotes(sessionId);
        
        // 5. è¿”å›æœ€é«˜ç¥¨ç­”æ¡ˆ
        return extractBestAnswer(result);
    }
}
```

---

## ğŸ¯ å®Œæ•´å®ç°ç¤ºä¾‹

### ç«¯åˆ°ç«¯RAGä¼˜åŒ–æ–¹æ¡ˆ
```java
@Service
@Slf4j
public class OptimizedRAGService {
    
    @Autowired
    private PPLStorageService pplStorage;
    
    @Autowired
    private HOPEKnowledgeManager hopeManager;
    
    @Autowired
    private BehaviorAnalysisService behaviorService;
    
    @Autowired
    private RAGService ragService;
    
    @Autowired
    private VotingArbiter votingArbiter;
    
    @Autowired
    private List<AIService> aiServices;
    
    @Autowired
    private QuestionClassifierLearningService learningService;
    
    /**
     * å®Œæ•´çš„ä¼˜åŒ–RAGæŸ¥è¯¢æµç¨‹
     */
    public OptimizedAnswer query(RAGRequest request) {
        String question = request.getQuestion();
        String userId = request.getUserId();
        String sessionId = request.getSessionId();
        
        log.info("å¼€å§‹ä¼˜åŒ–RAGæŸ¥è¯¢: question={}, user={}", question, userId);
        
        // ============ æ­¥éª¤1: é—®é¢˜åˆ†ç±» ============
        HOPEKnowledgeManager.QueryResult hopeResult = 
            hopeManager.smartQuery(question, sessionId);
        
        String questionType = hopeResult.getQuestionType();
        String suggestedLayer = hopeResult.getSuggestedLayer();
        double confidence = hopeResult.getConfidence();
        
        log.info("é—®é¢˜åˆ†ç±»: type={}, layer={}, confidence={}", 
                 questionType, suggestedLayer, confidence);
        
        // ============ æ­¥éª¤2: åŠ è½½PPLæ¨¡æ¿ ============
        Optional<PPLData> pplTemplate = pplStorage.getPPLData(questionType);
        String optimizedQuery = generateOptimizedQuery(question, pplTemplate);
        
        log.info("PPLä¼˜åŒ–æŸ¥è¯¢: {}", optimizedQuery);
        
        // ============ æ­¥éª¤3: è¡Œä¸ºåˆ†æ ============
        AttitudeScore attitude = behaviorService.inferAttitude(
            userId, sessionId
        );
        SearchStrategy strategy = adjustStrategyByAttitude(attitude);
        
        log.info("ç”¨æˆ·æ€åº¦: level={}, score={}", 
                 attitude.getLevel(), attitude.getScore());
        
        // ============ æ­¥éª¤4: æ™ºèƒ½æ£€ç´¢ ============
        List<SearchResult> ragResults = ragService.search(
            optimizedQuery,
            strategy.getTopK()
        );
        
        // æŒ‰ç”¨æˆ·åå¥½é‡æ–°æ’åº
        List<SearchResult> rankedResults = rankByUserBehavior(
            ragResults, userId, attitude
        );
        
        log.info("æ£€ç´¢åˆ°{}ä¸ªç»“æœ", rankedResults.size());
        
        // ============ æ­¥éª¤5: å¤šæ¨¡å‹æŠ•ç¥¨ ============
        String votingSessionId = votingArbiter.createSession(
            "RAG Answer for: " + question,
            buildContext(rankedResults)
        );
        
        Map<String, String> modelAnswers = new HashMap<>();
        
        for (AIService aiService : aiServices) {
            String prompt = buildPromptWithPPL(
                question, 
                rankedResults, 
                pplTemplate
            );
            
            AIResponse response = aiService.chat(prompt);
            String answer = response.getContent();
            modelAnswers.put(aiService.getModelName(), answer);
            
            // æŠ•ç¥¨
            votingArbiter.castVote(
                votingSessionId,
                aiService.getModelName(),
                Vote.builder()
                    .voterId(aiService.getModelName())
                    .voterType(VoterType.AI)
                    .decision(Vote.Decision.APPROVE)
                    .confidence(response.getConfidence())
                    .metadata(Map.of("answer", answer))
                    .build()
            );
        }
        
        VotingResult votingResult = votingArbiter.tallyVotes(votingSessionId);
        String finalAnswer = extractBestAnswer(votingResult, modelAnswers);
        
        log.info("æŠ•ç¥¨å®Œæˆ: æœ€ç»ˆç­”æ¡ˆæ¥è‡ª {}", votingResult.getWinningVoterId());
        
        // ============ æ­¥éª¤6: å­¦ä¹ åé¦ˆ ============
        learningService.recordClassificationResult(
            question,
            questionType,
            true  // å‡è®¾åˆ†ç±»æ­£ç¡®
        );
        
        // æ”¶é›†è¡Œä¸ºä¿¡å·
        behaviorService.collectSignal(
            BehaviorSignalEvent.builder()
                .userId(userId)
                .sessionId(sessionId)
                .signalType(SignalType.VIEW)
                .answerId(votingSessionId)
                .timestamp(System.currentTimeMillis())
                .build()
        );
        
        // ============ è¿”å›ä¼˜åŒ–ç»“æœ ============
        return OptimizedAnswer.builder()
            .answer(finalAnswer)
            .questionType(questionType)
            .confidence(votingResult.getConfidenceScore())
            .sources(rankedResults)
            .votingDetails(votingResult)
            .attitudeLevel(attitude.getLevel())
            .build();
    }
    
    /**
     * ç”ŸæˆPPLä¼˜åŒ–çš„æŸ¥è¯¢
     */
    private String generateOptimizedQuery(
        String question,
        Optional<PPLData> pplTemplate
    ) {
        if (pplTemplate.isEmpty()) {
            return question;
        }
        
        // è§£æPPLæ¨¡æ¿å¹¶åº”ç”¨
        // æå–å…³é”®è¯ã€æ‰©å±•ä¸Šä¸‹æ–‡ã€æ·»åŠ çº¦æŸç­‰
        return applyPPLOptimization(question, pplTemplate.get());
    }
    
    /**
     * æ ¹æ®ç”¨æˆ·è¡Œä¸ºæ’åºç»“æœ
     */
    private List<SearchResult> rankByUserBehavior(
        List<SearchResult> results,
        String userId,
        AttitudeScore attitude
    ) {
        // è·å–ç”¨æˆ·çš„å†å²è¡Œä¸ºåå¥½
        Map<String, Double> preferences = 
            behaviorService.getUserPreferences(userId);
        
        // é‡æ–°è®¡ç®—åˆ†æ•°
        return results.stream()
            .map(result -> {
                double originalScore = result.getScore();
                double preferenceScore = calculatePreferenceScore(
                    result, preferences
                );
                double attitudeWeight = getAttitudeWeight(attitude);
                
                double finalScore = originalScore * 0.6 + 
                                  preferenceScore * 0.3 + 
                                  attitudeWeight * 0.1;
                
                return result.withScore(finalScore);
            })
            .sorted(Comparator.comparing(SearchResult::getScore).reversed())
            .collect(Collectors.toList());
    }
    
    /**
     * ä½¿ç”¨PPLæ„å»ºæç¤ºè¯
     */
    private String buildPromptWithPPL(
        String question,
        List<SearchResult> contexts,
        Optional<PPLData> pplTemplate
    ) {
        if (pplTemplate.isEmpty()) {
            return buildStandardPrompt(question, contexts);
        }
        
        // ä»PPLæ¨¡æ¿æå–æç¤ºè¯ç»“æ„
        String template = extractPromptTemplate(pplTemplate.get());
        
        // å¡«å……å˜é‡
        return template
            .replace("{question}", question)
            .replace("{contexts}", formatContexts(contexts))
            .replace("{timestamp}", String.valueOf(System.currentTimeMillis()));
    }
}

/**
 * RAGè¯·æ±‚æ¨¡å‹
 */
@Data
@Builder
public class RAGRequest {
    private String question;
    private String userId;
    private String sessionId;
    private Map<String, Object> metadata;
}

/**
 * ä¼˜åŒ–ç­”æ¡ˆæ¨¡å‹
 */
@Data
@Builder
public class OptimizedAnswer {
    private String answer;
    private String questionType;
    private double confidence;
    private List<SearchResult> sources;
    private VotingResult votingDetails;
    private AttitudeLevel attitudeLevel;
}
```

---

## ğŸ“Š æ•ˆæœå¯¹æ¯”

### ä¼ ç»ŸRAG vs OmniAgentä¼˜åŒ–RAG

| æŒ‡æ ‡ | ä¼ ç»ŸRAG | OmniAgentä¼˜åŒ–RAG | æå‡ |
|------|---------|------------------|------|
| æ£€ç´¢ç²¾åº¦ | 60-70% | 85-95% | +25-35% â­ |
| ç­”æ¡ˆå‡†ç¡®ç‡ | 65-75% | 88-95% | +23-30% â­ |
| ä¸Šä¸‹æ–‡ç†è§£ | å¼± | å¼ºï¼ˆHOPEä¸‰å±‚ï¼‰ | æ˜¾è‘—æå‡ |
| æ„å›¾è¯†åˆ« | æ—  | æœ‰ï¼ˆè¡Œä¸ºåˆ†æï¼‰ | æ–°å¢èƒ½åŠ› |
| æç¤ºè¯è´¨é‡ | æ‰‹å·¥ | PPLè‡ªåŠ¨ä¼˜åŒ– | ä¸€è‡´æ€§é«˜ |
| å¤šæ¨¡å‹æŠ•ç¥¨ | æ—  | æœ‰ï¼ˆ4ç§ç­–ç•¥ï¼‰ | å¯é æ€§+30% |
| æŒç»­å­¦ä¹  | æ—  | æœ‰ï¼ˆè‡ªåŠ¨å­¦ä¹ ï¼‰ | æŒç»­æ”¹è¿› |
| æ–‡æ¡£åˆ†å— | å›ºå®šå¤§å° | æ™ºèƒ½è¯­ä¹‰åˆ†å— | ä¸Šä¸‹æ–‡+20% |
| æ£€ç´¢ç­–ç•¥ | å•ä¸€å‘é‡ | æ··åˆæ£€ç´¢+é‡æ’åº | ç²¾åº¦+15% |
| æŸ¥è¯¢ä¼˜åŒ– | åŸå§‹æŸ¥è¯¢ | æ‰©å±•+æ”¹å†™+åˆ†è§£ | å¬å›ç‡+25% |
| å…ƒæ•°æ®åˆ©ç”¨ | æ—  | æ™ºèƒ½è¿‡æ»¤ | ç²¾å‡†åº¦+18% |

### å„ä¼˜åŒ–æ–¹æ³•çš„æ•ˆæœæå‡

| ä¼˜åŒ–æ–¹æ³• | é€‚ç”¨åœºæ™¯ | ç²¾åº¦æå‡ | å®æ–½éš¾åº¦ |
|----------|----------|----------|----------|
| PPLæç¤ºè¯ä¼˜åŒ– | æ‰€æœ‰åœºæ™¯ | +20-25% | ä¸­ |
| æ™ºèƒ½æ–‡æ¡£åˆ†å— | é•¿æ–‡æ¡£æ£€ç´¢ | +15-20% | ä½ |
| æ··åˆæ£€ç´¢ç­–ç•¥ | å¤šæ ·åŒ–æŸ¥è¯¢ | +15-18% | ä¸­ |
| HOPEä¸‰å±‚è·¯ç”± | å¤šè½®å¯¹è¯ | +25-30% | ä¸­ |
| æŸ¥è¯¢æ‰©å±•æ”¹å†™ | çŸ­æŸ¥è¯¢ | +10-15% | ä½ |
| è¡Œä¸ºåˆ†æ | ä¸ªæ€§åŒ–åœºæ™¯ | +12-15% | é«˜ |
| è¯­ä¹‰é‡æ’åº | ç²¾å‡†åŒ¹é… | +8-12% | ä¸­ |
| å¤šæ¨¡å‹æŠ•ç¥¨ | é«˜å¯é æ€§éœ€æ±‚ | +20-30% | ä¸­ |
| å…ƒæ•°æ®è¿‡æ»¤ | ç»“æ„åŒ–æ•°æ® | +15-20% | ä½ |
| çŸ¥è¯†å›¾è°±å¢å¼º | å®ä½“å…³ç³»æŸ¥è¯¢ | +18-25% | é«˜ |

### å®é™…åº”ç”¨æ•ˆæœ
```
åœºæ™¯1: æŠ€æœ¯æ–‡æ¡£é—®ç­”
- ä¼ ç»ŸRAG: 68%å‡†ç¡®ç‡
- ä¼˜åŒ–RAG: 91%å‡†ç¡®ç‡
- æå‡: +23%

åœºæ™¯2: å¤šè½®å¯¹è¯
- ä¼ ç»ŸRAG: ä¸Šä¸‹æ–‡ä¸¢å¤±ç‡45%
- ä¼˜åŒ–RAG: ä¸Šä¸‹æ–‡ä¿æŒç‡92%
- æå‡: +47%

åœºæ™¯3: å¤æ‚ä¸šåŠ¡é—®é¢˜
- ä¼ ç»ŸRAG: 62%æ»¡æ„åº¦
- ä¼˜åŒ–RAG: 87%æ»¡æ„åº¦
- æå‡: +25%
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½®PPLå­˜å‚¨
```yaml
# application.yml
omni:
  storage:
    type: redis  # ä½¿ç”¨Rediså­˜å‚¨PPLæ¨¡æ¿
    redis:
      host: localhost
      port: 6379
```

### 2. åˆ›å»ºPPLæ¨¡æ¿
```java
@Component
public class PPLTemplateInitializer {
    
    @Autowired
    private PPLStorageService pplStorage;
    
    @PostConstruct
    public void initTemplates() {
        // æŠ€æœ¯é—®é¢˜æ¨¡æ¿
        pplStorage.savePPLData(
            "technical",
            loadTechnicalTemplate(),
            "Technical Q&A template"
        );
        
        // ä¸šåŠ¡é—®é¢˜æ¨¡æ¿
        pplStorage.savePPLData(
            "business",
            loadBusinessTemplate(),
            "Business Q&A template"
        );
    }
}
```

### 3. ä½¿ç”¨ä¼˜åŒ–RAG
```java
@RestController
@RequestMapping("/api/rag")
public class RAGController {
    
    @Autowired
    private OptimizedRAGService ragService;
    
    @PostMapping("/query")
    public OptimizedAnswer query(@RequestBody RAGRequest request) {
        return ragService.query(request);
    }
}
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [PPLå­˜å‚¨æœåŠ¡å®ç°](../omni-agent-core/src/main/java/top/yumbo/ai/omni/core/ppl/PPLStorageService.java)
- [HOPEçŸ¥è¯†ç®¡ç†å™¨](../omni-agent-core/src/main/java/top/yumbo/ai/omni/core/hope/HOPEKnowledgeManager.java)
- [è¡Œä¸ºåˆ†ææœåŠ¡](../omni-agent-behavior-api/src/main/java/top/yumbo/ai/behavior/api/BehaviorAnalysisService.java)
- [æŠ•ç¥¨ä»²è£å™¨](../omni-agent-core/src/main/java/top/yumbo/ai/omni/core/voting/VotingArbiter.java)
- [è¡Œä¸ºåˆ†ææŒ‡å—](../docs/BEHAVIOR_ANALYSIS_GUIDE.md)

---

## ğŸ’¡ æœ€ä½³å®è·µ

### DO - æ¨èåšæ³•

#### æç¤ºè¯ä¼˜åŒ–
```
âœ… ä¸ºä¸åŒç±»å‹é—®é¢˜åˆ›å»ºä¸“é—¨çš„PPLæ¨¡æ¿
âœ… å®šæœŸåˆ†æå’Œä¼˜åŒ–PPLæ¨¡æ¿æ•ˆæœ
âœ… æ”¶é›†ä¼˜è´¨æç¤ºè¯æ¡ˆä¾‹å»ºç«‹æ¨¡æ¿åº“
âœ… ä½¿ç”¨A/Bæµ‹è¯•éªŒè¯æç¤ºè¯æ•ˆæœ
```

#### æ–‡æ¡£åˆ†å—
```
âœ… æ ¹æ®æ–‡æ¡£ç±»å‹é€‰æ‹©åˆé€‚çš„åˆ†å—ç­–ç•¥
âœ… ä½¿ç”¨é‡å åˆ†å—ä¿æŒä¸Šä¸‹æ–‡è¿ç»­æ€§
âœ… ä¿æŒä»£ç å—çš„å®Œæ•´æ€§ï¼ˆä¸è¦åˆ‡æ–­å‡½æ•°ï¼‰
âœ… ä¸ºåˆ†å—æ·»åŠ ç»“æ„åŒ–å…ƒæ•°æ®ï¼ˆæ ‡é¢˜ã€ç« èŠ‚ï¼‰
```

#### æ£€ç´¢ä¼˜åŒ–
```
âœ… ä½¿ç”¨æ··åˆæ£€ç´¢ç­–ç•¥ï¼ˆå‘é‡+å…³é”®è¯ï¼‰
âœ… å¯¹å€™é€‰ç»“æœè¿›è¡Œè¯­ä¹‰é‡æ’åº
âœ… æ ¹æ®æŸ¥è¯¢ç±»å‹åŠ¨æ€è°ƒæ•´topKå€¼
âœ… ä½¿ç”¨æŸ¥è¯¢æ‰©å±•æé«˜å¬å›ç‡
```

#### çŸ¥è¯†ç®¡ç†
```
âœ… ä½¿ç”¨HOPEä¸‰å±‚è·¯ç”±å‡å°‘ä¸å¿…è¦çš„å…¨æ–‡æ£€ç´¢
âœ… é«˜é¢‘æŸ¥è¯¢ä¼˜å…ˆæ£€æŸ¥ä¼šè¯ä¸Šä¸‹æ–‡
âœ… å®šæœŸæ¸…ç†å’Œæ›´æ–°çŸ¥è¯†åº“
âœ… å¯¹é‡è¦çŸ¥è¯†å»ºç«‹ç´¢å¼•åŠ é€Ÿæ£€ç´¢
```

#### ç”¨æˆ·ä½“éªŒ
```
âœ… å¯ç”¨è¡Œä¸ºåˆ†ææŒç»­ä¼˜åŒ–æ£€ç´¢ç­–ç•¥
âœ… æ ¹æ®ç”¨æˆ·æ€åº¦è°ƒæ•´ç»“æœå‘ˆç°
âœ… æ”¶é›†ç”¨æˆ·åé¦ˆè¿›è¡Œè‡ªåŠ¨å­¦ä¹ 
âœ… æä¾›ç»“æœè§£é‡Šå’Œæ¥æºé“¾æ¥
```

#### è´¨é‡ä¿è¯
```
âœ… ä½¿ç”¨å¤šæ¨¡å‹æŠ•ç¥¨æé«˜ç­”æ¡ˆå¯é æ€§
âœ… è®¾ç½®ç½®ä¿¡åº¦é˜ˆå€¼è¿‡æ»¤ä½è´¨é‡ç»“æœ
âœ… å¯¹å…³é”®ä¸šåŠ¡åœºæ™¯è¿›è¡Œäººå·¥å®¡æ ¸
âœ… å»ºç«‹ç­”æ¡ˆè´¨é‡è¯„ä¼°æœºåˆ¶
```

### DON'T - é¿å…åšæ³•

#### æ£€ç´¢ç­–ç•¥
```
âŒ ä¸è¦å¯¹æ‰€æœ‰é—®é¢˜ä½¿ç”¨ç›¸åŒçš„æ£€ç´¢ç­–ç•¥
âŒ ä¸è¦å¿½ç•¥æŸ¥è¯¢ç±»å‹ç›´æ¥å…¨æ–‡æ£€ç´¢
âŒ ä¸è¦ä½¿ç”¨è¿‡å¤§æˆ–è¿‡å°çš„åˆ†å—å¤§å°
âŒ ä¸è¦å¿½ç•¥æ–‡æ¡£çš„ç»“æ„ä¿¡æ¯
```

#### æ•°æ®ç®¡ç†
```
âŒ ä¸è¦å¿½ç•¥ç”¨æˆ·çš„å†å²è¡Œä¸ºæ•°æ®
âŒ ä¸è¦æ··æ‚ä¸åŒæ—¶æœŸ/ç‰ˆæœ¬çš„æ–‡æ¡£
âŒ ä¸è¦å¿½ç•¥å…ƒæ•°æ®çš„ä»·å€¼
âŒ ä¸è¦è®©çŸ¥è¯†åº“é•¿æœŸä¸æ›´æ–°
```

#### æµç¨‹è®¾è®¡
```
âŒ ä¸è¦è·³è¿‡é—®é¢˜åˆ†ç±»ç›´æ¥æ£€ç´¢
âŒ ä¸è¦å¿½ç•¥HOPEä¸‰å±‚çš„ä¼˜å…ˆçº§
âŒ ä¸è¦åœ¨æ²¡æœ‰ä¸Šä¸‹æ–‡æ—¶å¼ºè¡Œä½¿ç”¨ä¸Šä¸‹æ–‡
âŒ ä¸è¦å¿½ç•¥æŸ¥è¯¢æ”¹å†™å’Œæ‰©å±•
```

#### æ¨¡å‹ä½¿ç”¨
```
âŒ ä¸è¦åªä¾èµ–å•ä¸€æ¨¡å‹çš„ç­”æ¡ˆ
âŒ ä¸è¦ä½¿ç”¨é”™è¯¯çš„embeddingæ¨¡å‹
âŒ ä¸è¦å¿½ç•¥æ¨¡å‹çš„tokené™åˆ¶
âŒ ä¸è¦åœ¨æ‰€æœ‰åœºæ™¯éƒ½ä½¿ç”¨æœ€å¤§çš„æ¨¡å‹
```

#### åé¦ˆå­¦ä¹ 
```
âŒ ä¸è¦å¿˜è®°æ”¶é›†å’Œå­¦ä¹ ç”¨æˆ·åé¦ˆ
âŒ ä¸è¦å¿½ç•¥è´Ÿé¢åé¦ˆ
âŒ ä¸è¦è®©å­¦ä¹ ç³»ç»Ÿé•¿æœŸä¸è¿è¡Œ
âŒ ä¸è¦è¿‡åº¦æ‹Ÿåˆå°‘æ•°ç”¨æˆ·çš„åå¥½
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### ç¼“å­˜ç­–ç•¥
```
âœ… ç¼“å­˜çƒ­é—¨æŸ¥è¯¢çš„ç»“æœï¼ˆLRUç¼“å­˜ï¼‰
âœ… ç¼“å­˜å‘é‡è®¡ç®—ç»“æœ
âœ… ç¼“å­˜PPLæ¨¡æ¿è§£æç»“æœ
âœ… ä½¿ç”¨Redisç¼“å­˜ä¼šè¯ä¸Šä¸‹æ–‡
```

#### å¹¶å‘ä¼˜åŒ–
```
âœ… å¹¶è¡Œæ‰§è¡Œå¤šæŸ¥è¯¢æ‰©å±•
âœ… å¼‚æ­¥è®¡ç®—å‘é‡å’Œå…³é”®è¯æ£€ç´¢
âœ… ä½¿ç”¨æ‰¹å¤„ç†æé«˜embeddingæ•ˆç‡
âœ… åˆç†æ§åˆ¶å¹¶å‘æ•°é¿å…èµ„æºè€—å°½
```

#### æˆæœ¬æ§åˆ¶
```
âœ… æ ¹æ®é‡è¦æ€§é€‰æ‹©åˆé€‚çš„æ¨¡å‹
âœ… ä½¿ç”¨ç¼“å­˜å‡å°‘LLMè°ƒç”¨
âœ… å¯¹ç®€å•æŸ¥è¯¢ä½¿ç”¨å°æ¨¡å‹
âœ… è®¾ç½®tokenä½¿ç”¨ä¸Šé™
```

---

## ğŸ¯ æ€»ç»“

### æ ¸å¿ƒä¼˜åŠ¿ï¼ˆ10ç§ä¼˜åŒ–æ–¹æ³•ï¼‰

#### 1. PPLæç¤ºè¯ä¼˜åŒ– â­â­â­
- **æ•ˆæœ**: ç²¾åº¦+20-25%
- **åŸç†**: ç¨‹åºåŒ–ç”Ÿæˆé¢†åŸŸç‰¹å®šçš„é«˜è´¨é‡æç¤ºè¯
- **é€‚ç”¨**: æ‰€æœ‰RAGåœºæ™¯

#### 2. æ™ºèƒ½æ–‡æ¡£åˆ†å— â­â­â­
- **æ•ˆæœ**: ä¸Šä¸‹æ–‡+15-20%
- **åŸç†**: è¯­ä¹‰æ„ŸçŸ¥åˆ†å—ã€ç»“æ„åŒ–åˆ†å—ã€é‡å åˆ†å—
- **é€‚ç”¨**: é•¿æ–‡æ¡£ã€ä»£ç æ–‡æ¡£ã€ç»“æ„åŒ–å†…å®¹

#### 3. æ··åˆæ£€ç´¢ç­–ç•¥ â­â­â­
- **æ•ˆæœ**: ç²¾åº¦+15-18%
- **åŸç†**: å‘é‡æ£€ç´¢+å…³é”®è¯æ£€ç´¢+è¯­ä¹‰é‡æ’åº
- **é€‚ç”¨**: å¤šæ ·åŒ–æŸ¥è¯¢åœºæ™¯

#### 4. HOPEæ™ºèƒ½è·¯ç”± â­â­â­
- **æ•ˆæœ**: æ•ˆç‡+25-30%
- **åŸç†**: ä¸‰å±‚çŸ¥è¯†åˆ†å±‚æ£€ç´¢ï¼ˆé«˜é¢‘/ä¸­é¢‘/ä½é¢‘ï¼‰
- **é€‚ç”¨**: å¤šè½®å¯¹è¯ã€é«˜é¢‘æŸ¥è¯¢

#### 5. æŸ¥è¯¢æ‰©å±•æ”¹å†™ â­â­
- **æ•ˆæœ**: å¬å›ç‡+10-15%
- **åŸç†**: HyDEã€å¤šæŸ¥è¯¢æ‰©å±•ã€æŸ¥è¯¢åˆ†è§£
- **é€‚ç”¨**: çŸ­æŸ¥è¯¢ã€å¤æ‚æŸ¥è¯¢

#### 6. è¡Œä¸ºåˆ†æå¢å¼º â­â­
- **æ•ˆæœ**: ä¸ªæ€§åŒ–+12-15%
- **åŸç†**: ç”¨æˆ·æ„å›¾ç†è§£ã€æ€åº¦æ¨æ–­ã€ç»“æœæ’åº
- **é€‚ç”¨**: ä¸ªæ€§åŒ–æ¨èåœºæ™¯

#### 7. è¯­ä¹‰é‡æ’åº â­â­
- **æ•ˆæœ**: ç²¾å‡†åº¦+8-12%
- **åŸç†**: ä½¿ç”¨æ›´å¼ºæ¨¡å‹é‡æ–°è®¡ç®—ç›¸å…³åº¦
- **é€‚ç”¨**: ç²¾å‡†åŒ¹é…éœ€æ±‚

#### 8. å¤šæ¨¡å‹æŠ•ç¥¨ â­â­â­
- **æ•ˆæœ**: å¯é æ€§+20-30%
- **åŸç†**: å¤šä¸ªAIæ¨¡å‹ç”Ÿæˆç­”æ¡ˆå¹¶æŠ•ç¥¨
- **é€‚ç”¨**: é«˜å¯é æ€§éœ€æ±‚

#### 9. å…ƒæ•°æ®è¿‡æ»¤ â­â­
- **æ•ˆæœ**: ç²¾å‡†åº¦+15-20%
- **åŸç†**: åŸºäºæ—¶é—´ã€ç±»å‹ã€ç‰ˆæœ¬ç­‰å…ƒæ•°æ®è¿‡æ»¤
- **é€‚ç”¨**: ç»“æ„åŒ–æ•°æ®ã€ç‰ˆæœ¬æ§åˆ¶

#### 10. çŸ¥è¯†å›¾è°±å¢å¼º â­â­â­
- **æ•ˆæœ**: å®ä½“å…³ç³»+18-25%
- **åŸç†**: ä½¿ç”¨çŸ¥è¯†å›¾è°±æ‰©å±•æŸ¥è¯¢å’Œç­”æ¡ˆ
- **é€‚ç”¨**: å®ä½“å…³ç³»æŸ¥è¯¢ã€ä¸“ä¸šé¢†åŸŸ

### ç»„åˆä½¿ç”¨å»ºè®®

#### åŸºç¡€é…ç½®ï¼ˆç²¾åº¦+30-40%ï¼‰
```
âœ… PPLæç¤ºè¯ä¼˜åŒ–
âœ… æ™ºèƒ½æ–‡æ¡£åˆ†å—
âœ… æ··åˆæ£€ç´¢ç­–ç•¥
```

#### è¿›é˜¶é…ç½®ï¼ˆç²¾åº¦+50-60%ï¼‰
```
âœ… åŸºç¡€é…ç½®
âœ… HOPEæ™ºèƒ½è·¯ç”±
âœ… æŸ¥è¯¢æ‰©å±•æ”¹å†™
âœ… è¯­ä¹‰é‡æ’åº
```

#### ä¸“ä¸šé…ç½®ï¼ˆç²¾åº¦+70-80%ï¼‰â­
```
âœ… è¿›é˜¶é…ç½®
âœ… è¡Œä¸ºåˆ†æå¢å¼º
âœ… å¤šæ¨¡å‹æŠ•ç¥¨
âœ… å…ƒæ•°æ®è¿‡æ»¤
```

#### ä¼ä¸šçº§é…ç½®ï¼ˆç²¾åº¦+80-90%ï¼‰â­â­
```
âœ… ä¸“ä¸šé…ç½®
âœ… çŸ¥è¯†å›¾è°±å¢å¼º
âœ… æŒç»­å­¦ä¹ ä¼˜åŒ–
âœ… å¤šæ¨¡æ€æ£€ç´¢
```

### æŠ€æœ¯äº®ç‚¹
- âœ… 31,104ç§ç»„åˆçµæ´»é…ç½®
- âœ… æ£€ç´¢ç²¾åº¦æå‡25-35%ï¼ˆæœ€é«˜å¯è¾¾90%+ï¼‰
- âœ… ç­”æ¡ˆå‡†ç¡®ç‡æå‡23-30%
- âœ… æ”¯æŒå¤æ‚å¤šè½®å¯¹è¯
- âœ… å®Œå…¨å¯æ’æ‹”æ¶æ„
- âœ… 10ç§ä¼˜åŒ–æ–¹æ³•å¯ä»»æ„ç»„åˆ
- âœ… ä»åŸºç¡€åˆ°ä¼ä¸šçº§å…¨è¦†ç›–

### å®æ–½è·¯çº¿å›¾

#### Phase 1: å¿«é€Ÿè§æ•ˆï¼ˆ1-2å‘¨ï¼‰
```
Week 1: å®æ–½PPLæç¤ºè¯ä¼˜åŒ– â†’ ç²¾åº¦+20%
Week 2: å®æ–½æ™ºèƒ½æ–‡æ¡£åˆ†å— â†’ ç²¾åº¦+15%
æ€»æå‡: ~35%
```

#### Phase 2: æ·±åº¦ä¼˜åŒ–ï¼ˆ3-4å‘¨ï¼‰
```
Week 3: å®æ–½æ··åˆæ£€ç´¢+é‡æ’åº â†’ ç²¾åº¦+15%
Week 4: é›†æˆHOPEæ™ºèƒ½è·¯ç”± â†’ æ•ˆç‡+30%
æ€»æå‡: ~50%
```

#### Phase 3: é«˜çº§åŠŸèƒ½ï¼ˆ5-8å‘¨ï¼‰
```
Week 5-6: è¡Œä¸ºåˆ†æ+å¤šæ¨¡å‹æŠ•ç¥¨ â†’ å¯é æ€§+25%
Week 7-8: å…ƒæ•°æ®è¿‡æ»¤+çŸ¥è¯†å›¾è°± â†’ ç²¾å‡†åº¦+20%
æ€»æå‡: ~70-80%
```

### åº”ç”¨ä»·å€¼
é€šè¿‡OmniAgentçš„ä¸ƒç»´æ¶æ„ï¼Œç»“åˆ10ç§ä¼˜åŒ–æ–¹æ³•ï¼Œå¯ä»¥ï¼š
- ğŸ“ˆ **æ£€ç´¢ç²¾åº¦**: ä»60-70%æå‡åˆ°85-95%
- ğŸ¯ **ç­”æ¡ˆå‡†ç¡®ç‡**: ä»65-75%æå‡åˆ°88-95%
- ğŸ’¡ **ç”¨æˆ·æ»¡æ„åº¦**: ä»60%æå‡åˆ°85-90%
- âš¡ **å“åº”é€Ÿåº¦**: é€šè¿‡HOPEè·¯ç”±å‡å°‘50%æ— æ•ˆæ£€ç´¢
- ğŸ”„ **æŒç»­æ”¹è¿›**: è‡ªåŠ¨å­¦ä¹ ç”¨æˆ·åé¦ˆæŒç»­ä¼˜åŒ–

è¿™äº›æ–¹æ³•å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç»„åˆä½¿ç”¨ï¼Œåœ¨ä¿æŒæ¶æ„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§çš„åŒæ—¶ï¼Œæ˜¾è‘—æé«˜RAGçš„æ£€ç´¢ç²¾åº¦å’Œç­”æ¡ˆè´¨é‡ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2025-12-15  
**é€‚ç”¨ç‰ˆæœ¬**: OmniAgent 1.0.0+  
**æŠ€æœ¯æ”¯æŒ**: OmniAgent Team

