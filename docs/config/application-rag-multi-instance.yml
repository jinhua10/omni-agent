# RAG 多实例配置示例
# 支持动态创建多个 RAG 服务实例，每个实例可以使用不同的存储和向量化配置

omni-agent:
  rag:
    # 全局向量维度（默认值，各实例可以覆盖）
    vector-dimension: 768

    # RAG 实例列表
    instances:
      # ========== 实例 1: File + ONNX（本地向量化） ==========
      - id: file-onnx
        name: "文件存储+本地模型"
        type: file
        primary: true  # 主实例，会被自动注入到 @Autowired RagService

        # File/Lucene 配置
        file:
          index-path: data/rag-index/file
          ram-buffer-size-mb: 32.0

        # 嵌入模型配置（可选）
        embedding:
          provider: onnx
          model: bge-base-zh-v1.5
          dimension: 768
          onnx:
            model-path: models/bge-base-zh-v1.5/model.onnx
            vocab-path: models/bge-base-zh-v1.5/vocab.txt
            max-length: 512

      # ========== 实例 2: SQLite + Ollama（本地大模型） ==========
      - id: sqlite-ollama
        name: "SQLite+Ollama"
        type: sqlite

        sqlite:
          database-path: data/rag-index/sqlite/rag.db
          init-database: true
          enable-fts: true

        embedding:
          provider: ollama
          dimension: 768
          ollama:
            base-url: http://localhost:11434
            model: nomic-embed-text
            timeout: 30000

      # ========== 实例 3: MongoDB + Online API（云端向量化） ==========
      - id: mongodb-online
        name: "MongoDB+在线API"
        type: mongodb

        mongodb:
          collection-name: rag_documents
          enable-text-search: true

        embedding:
          provider: online
          dimension: 1536
          online:
            endpoint: https://api.openai.com/v1/embeddings
            api-key: ${OPENAI_API_KEY}
            model: text-embedding-ada-002
            timeout: 30000

      # ========== 实例 4: Redis（高性能，无向量化） ==========
      - id: redis-storage
        name: "Redis高性能存储"
        type: redis

        redis:
          key-prefix: "omni-rag:"
          document-ttl: 86400  # 24小时
          enable-text-index: true

        # 不配置 embedding，则该实例只提供存储功能

---
# 简单配置（单实例）
omni-agent:
  rag:
    instances:
      - id: default
        type: file
        primary: true
        file:
          index-path: data/rag-index

---
# 如果不配置任何实例，系统会自动创建一个默认的 File 实例
omni-agent:
  rag:
    # 空配置，会自动创建 default File 实例

